<?php
 namespace Optimization\Purge; use Optimization\Util\FormatUtil; use Optimization\Util\I18NUtil; use CallbackFilterIterator; class Expired extends Common { const EVENT_NAME = "\x6f\x70\x74\x69\x6d\x69\x7a\141\164\x69\x6f\156\x5f\x70\165\x72\x67\145\x5f\x74\x69\155\145\137\145\166\x65\x6e\x74"; public function __construct(?string $GuTuU) { parent::__construct($GuTuU); } public function getPath() : ?string { return $this->path; } public function addActions() : self { $this->addAction("\151\156\151\164", [$this, "\x73\x63\150\x65\144\x75\x6c\145\x45\x76\x65\x6e\x74"]); return parent::addActions(); } public function scheduleEvent() { goto vxa9H; PTMK3: jncYd: goto snWxw; lSQfg: $khcPf = $this->get_interval(); goto eyXo3; eyXo3: wp_schedule_event(time() + $khcPf, "\x72\157\x63\x6b\145\164\137\x65\170\160\151\x72\x65\x64\137\143\141\x63\150\x65\137\x63\x72\157\156\x5f\x69\x6e\164\x65\x72\x76\141\154", static::EVENT_NAME); goto PTMK3; vxa9H: if (!($this->get_cache_lifespan() && !wp_next_scheduled(static::EVENT_NAME))) { goto jncYd; } goto lSQfg; snWxw: } private function isDirectoryEmpty($GuTuU) { goto VuwJm; ty4N6: Kmxxi: goto kwtCH; Pwi0D: foreach ($T1d9t as $kJMVe) { goto Rsfgw; Y8wt2: LxO86: goto yTGhB; dtYVQ: B9bl_: goto igHYf; HxYBP: goto LxO86; goto dtYVQ; igHYf: return false; goto Y8wt2; Rsfgw: if (!$kJMVe->isDot()) { goto B9bl_; } goto HxYBP; yTGhB: } goto ty4N6; VuwJm: $T1d9t = $this->getIterator($GuTuU); goto Pwi0D; kwtCH: return true; goto SFy9W; SFy9W: } private function getCacheFilesInDir($wpkb5) { goto fAo8_; e200M: return false; goto W5dTB; gUCHS: $ow7fH = rtrim($wpkb5["\x70\141\164\x68"], "\57"); goto rAsnr; Q14gZ: MRo7e: goto e200M; fAo8_: $LnYdB = "\100\136" . preg_quote($wpkb5["\x68\x6f\163\164"], "\x40") . "\x40"; goto BgmOt; tpZUj: return new CallbackFilterIterator($T1d9t, function ($BmBdh) use($LnYdB, $ow7fH) { goto Vw9IN; a3aOc: if (!('' !== $ow7fH && !getFilesystem()::exists($BmBdh->getPathname() . $ow7fH))) { goto AwDAG; } goto yL0u7; OajnS: return false; goto RrLsr; Na4vh: return false; goto cgAgy; C3QL0: return true; goto YftU7; RrLsr: V1vrH: goto zRMhy; zRMhy: if (preg_match($LnYdB, $BmBdh->getFilename())) { goto AP_AH; } goto Na4vh; yL0u7: return false; goto IGAze; cgAgy: AP_AH: goto a3aOc; Vw9IN: if (!(!$BmBdh->isDir() || $BmBdh->isDot())) { goto V1vrH; } goto OajnS; IGAze: AwDAG: goto C3QL0; YftU7: }); goto Q14gZ; rAsnr: if (!$T1d9t) { goto MRo7e; } goto tpZUj; BgmOt: $T1d9t = Util::getIterator($this->getPath()); goto gUCHS; W5dTB: } public function purgeExpiredFiles($KkOdX) { goto M4xaU; ln8oC: foreach ($BWnT3 as $hgTz4) { goto etjP9; FnPqK: v_4v1: goto gJ3bI; gJ3bI: if (!$dxNRn) { goto EJSL8; } goto kYN49; YzgI4: $CVKvJ = ["\x75\162\x6c" => $hgTz4, "\154\x69\146\145\163\x70\141\156" => $KkOdX, "\x66\x69\x6c\145\137\x61\x67\x65\x5f\154\151\155\x69\164" => $HJNmz]; goto zWA_I; Ar2i2: $Y8kin = rtrim($wpkb5["\160\141\x74\150"], "\x2f"); goto uWIU_; Qh9Ls: CZkp9: goto pIbrg; CvGVE: if (!$this->applyFilters("\x6f\160\x74\x69\155\151\172\x61\x74\x69\x6f\156\137\165\x72\154\x5f\156\x6f\x5f\144\157\x74\x73", false)) { goto iESSq; } goto lQaj5; Om29x: n2BqL: goto YzgI4; kYN49: $HC3jy = array_merge($HC3jy, $dxNRn); goto Xl47z; zWA_I: do_action("\x63\141\143\x68\145\137\141\146\164\x65\162\x5f\x61\x75\164\x6f\x6d\x61\x74\151\143\x5f\x63\141\143\150\x65\x5f\x70\x75\x72\x67\145\x5f\144\151\x72", $dxNRn, $CVKvJ); goto Qh9Ls; j2KLI: $wpkb5 = FormatUtil::getParseUrl($hgTz4); goto CvGVE; Fr0o2: if (!$XvAIE) { goto n2BqL; } goto j2KLI; etjP9: do_action("\x63\141\x63\150\145\x5f\x62\145\146\x6f\x72\x65\x5f\x61\165\x74\x6f\155\141\164\x69\143\137\143\x61\143\x68\x65\137\x70\165\x72\x67\x65\x5f\144\x69\x72", $hgTz4, $HJNmz); goto NtbiN; NtbiN: $dxNRn = []; goto Fr0o2; lQaj5: $wpkb5["\150\157\x73\x74"] = str_replace("\x2e", "\x5f", $wpkb5["\150\157\163\164"]); goto O77Ws; O77Ws: iESSq: goto Ar2i2; uWIU_: $KWSCi = $this->getCacheFilesInDir($wpkb5); goto GJZ2R; GJZ2R: foreach ($KWSCi as $kJMVe) { goto WQyCZ; xKrdy: $QezH8 = $yr2qb . $Y8kin; goto ScpPD; lazca: if (!$this->isDirectoryEmpty($yr2qb)) { goto dDYO8; } goto hvrCt; xUwqr: $dxNRn[] = ["\150\157\155\145\137\x75\x72\154" => $hgTz4, "\150\x6f\x6d\x65\137\160\x61\x74\150" => $QezH8, "\x6c\x6f\x67\147\145\x64\x5f\x69\156" => $yr2qb !== $this->getPath() . $wpkb5["\150\157\163\x74"], "\146\x69\x6c\145\x73" => $ueLJI]; goto y_xJV; ScpPD: $ueLJI = $this->purgeDirectory($QezH8, $HJNmz); goto ZsXZG; ik_IL: YQkwP: goto kfRuP; WQyCZ: $yr2qb = $kJMVe->getPathname(); goto xKrdy; XDyMA: dDYO8: goto ik_IL; ZsXZG: if (!$ueLJI) { goto Y3uWD; } goto xUwqr; hvrCt: getFilesystem()::remove($yr2qb); goto XDyMA; y_xJV: Y3uWD: goto lazca; kfRuP: } goto FnPqK; Xl47z: EJSL8: goto Om29x; pIbrg: } goto LSL0N; HkU7k: $BWnT3 = array_filter($BWnT3, "\x69\x73\137\163\164\x72\151\x6e\x67"); goto KgKm8; XcBBx: if (is_array($BWnT3)) { goto VSq_S; } goto hPCw1; gT5hJ: if (!$BWnT3) { goto ybQsD; } goto sOcCl; i3Rne: VSq_S: goto HkU7k; KeZDG: ybQsD: goto nuoll; LSL0N: LgMa2: goto UQQTa; X3W23: $oEaun = $BWnT3 = I18NUtil::getUri(); goto PMIVk; nuysP: do_action("\143\141\143\150\145\137\x61\x66\x74\145\162\137\x61\165\x74\x6f\155\141\164\x69\143\137\143\141\143\x68\x65\137\160\x75\x72\147\x65", $HC3jy, $CVKvJ); goto KeZDG; PMIVk: $HJNmz = time() - $KkOdX; goto HbK5J; xChMv: $HC3jy = []; goto ml0Eu; sOcCl: $BWnT3 = array_unique($BWnT3); goto xChMv; ml0Eu: $XvAIE = Buffer::canGenerateCachingFiles(); goto ln8oC; KgKm8: $BWnT3 = array_filter($BWnT3); goto gT5hJ; UQQTa: $CVKvJ = ["\154\x69\x66\145\163\x70\x61\156" => $KkOdX, "\146\x69\154\x65\x5f\141\x67\x65\137\154\x69\155\151\164" => $HJNmz]; goto nuysP; nuoll: kVdsx: goto f5_cs; HbK5J: $BWnT3 = $this->applyFilters("\143\141\x63\x68\x65\x5f\x61\165\x74\157\155\141\x74\151\x63\x5f\143\x61\x63\150\145\137\x70\x75\x72\x67\x65\137\x75\x72\x6c\163", $BWnT3, $HJNmz); goto XcBBx; M4xaU: if (!$KkOdX) { goto kVdsx; } goto X3W23; hPCw1: $BWnT3 = $oEaun; goto i3Rne; f5_cs: } private function purgeDirectory($GuTuU, $HJNmz) { goto FKltF; cTrTL: DYj1t: goto CnGtC; FKltF: $HC3jy = []; goto BIz2U; RD_fC: foreach ($T1d9t as $kJMVe) { goto i_DSQ; ity_v: $GuTuU = dirname($D2KXr); goto St5Zz; K33Vh: if (getFilesystem()::remove($D2KXr)) { goto KnEEK; } goto Ilt_u; St5Zz: if (in_array($GuTuU, $HC3jy, true)) { goto cYngB; } goto Y3yLe; xcH1s: DKBXY: goto kOkau; PaxDn: if ($kJMVe->isDir()) { goto gM0lX; } goto I0Plq; p_W20: cYngB: goto xcH1s; Ilt_u: goto aXI7Z; goto o0PbZ; PEhM7: HxHPJ: goto OVqWU; i_DSQ: if (!$kJMVe->isDot()) { goto u9V2M; } goto GkE0n; k2B5P: gM0lX: goto yBgtZ; Y3yLe: $HC3jy[] = $GuTuU; goto p_W20; PBW8i: goto DKBXY; goto PEhM7; kOkau: aXI7Z: goto AqDCx; GkE0n: goto aXI7Z; goto PWhlk; I0Plq: if ($kJMVe->isFile() && $kJMVe->getCTime() < $HJNmz) { goto HxHPJ; } goto yIFw3; OVqWU: $D2KXr = $kJMVe->getPathname(); goto K33Vh; yIFw3: goto DKBXY; goto k2B5P; PWhlk: u9V2M: goto PaxDn; yBgtZ: $Nbfw8 = $this->purgeDirectory($kJMVe->getPathname(), $HJNmz); goto DxRhz; o0PbZ: KnEEK: goto ity_v; DxRhz: $HC3jy = array_merge($HC3jy, $Nbfw8); goto PBW8i; AqDCx: } goto cTrTL; aMis9: SXu7Z: goto ZSTt2; BIz2U: $T1d9t = Util::getIterator($GuTuU); goto RD_fC; QH4zo: getFilesystem()::remove($GuTuU); goto aMis9; CnGtC: if (!$this->isDirectoryEmpty($GuTuU)) { goto SXu7Z; } goto QH4zo; ZSTt2: return $HC3jy; goto m2qEI; m2qEI: } }
