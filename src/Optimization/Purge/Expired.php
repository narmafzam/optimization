<?php
 namespace Optimization\Purge; use Optimization\Util\FormatUtil; use Optimization\Util\I18NUtil; use CallbackFilterIterator; class Expired extends Common { const EVENT_NAME = "\x6f\160\164\x69\155\x69\172\141\164\151\x6f\156\x5f\160\165\x72\x67\145\137\x74\x69\155\145\137\145\x76\x65\156\x74"; public function __construct(?string $GuTuU) { parent::__construct($GuTuU); } public function getPath() : ?string { return $this->path; } public function addActions() : self { $this->addAction("\x69\x6e\x69\164", [$this, "\163\143\x68\x65\144\165\x6c\145\105\x76\145\x6e\164"]); return parent::addActions(); } public function scheduleEvent() { goto sKif_; sKif_: if (!($this->get_cache_lifespan() && !wp_next_scheduled(static::EVENT_NAME))) { goto mDiWx; } goto RT7g1; zTF3r: mDiWx: goto k_NS4; qbdoP: wp_schedule_event(time() + $khcPf, "\162\x6f\x63\x6b\x65\x74\137\x65\170\160\151\x72\x65\x64\x5f\x63\141\x63\150\145\137\143\x72\x6f\156\137\x69\156\x74\145\x72\166\x61\x6c", static::EVENT_NAME); goto zTF3r; RT7g1: $khcPf = $this->get_interval(); goto qbdoP; k_NS4: } private function isDirectoryEmpty($GuTuU) { goto EKriE; vjw8t: return true; goto cEmhO; DQUp8: foreach ($T1d9t as $kJMVe) { goto dv34u; TGKYy: return false; goto cJ850; fb3b1: goto Q0LT3; goto SnvtH; dv34u: if (!$kJMVe->isDot()) { goto yfMeC; } goto fb3b1; SnvtH: yfMeC: goto TGKYy; cJ850: Q0LT3: goto QP99H; QP99H: } goto y0BuZ; y0BuZ: vLl93: goto vjw8t; EKriE: $T1d9t = $this->getIterator($GuTuU); goto DQUp8; cEmhO: } private function getCacheFilesInDir($wpkb5) { goto NzdQu; dnYPj: return new CallbackFilterIterator($T1d9t, function ($BmBdh) use($LnYdB, $ow7fH) { goto iaEBN; ThB0T: return false; goto CtYaw; MVnDC: return false; goto vaywF; jAySl: return false; goto Hed1J; TqOaO: if (!('' !== $ow7fH && !getFilesystem()::exists($BmBdh->getPathname() . $ow7fH))) { goto S9g9n; } goto jAySl; CtYaw: LV1ml: goto TqOaO; Sz36I: if (preg_match($LnYdB, $BmBdh->getFilename())) { goto LV1ml; } goto ThB0T; vaywF: Pb73J: goto Sz36I; vLEXT: return true; goto uF3FO; Hed1J: S9g9n: goto vLEXT; iaEBN: if (!(!$BmBdh->isDir() || $BmBdh->isDot())) { goto Pb73J; } goto MVnDC; uF3FO: }); goto zNGas; pCJX4: return false; goto BlSyN; zTRSy: $T1d9t = Util::getIterator($this->getPath()); goto HN41o; JsvWP: if (!$T1d9t) { goto iE3QL; } goto dnYPj; NzdQu: $LnYdB = "\100\136" . preg_quote($wpkb5["\x68\x6f\x73\x74"], "\x40") . "\100"; goto zTRSy; HN41o: $ow7fH = rtrim($wpkb5["\x70\x61\x74\x68"], "\57"); goto JsvWP; zNGas: iE3QL: goto pCJX4; BlSyN: } public function purgeExpiredFiles($KkOdX) { goto oaJUO; H2N9L: $BWnT3 = $oEaun; goto irjIE; A4KrT: xEN0E: goto MHBgX; hMMnw: $oEaun = $BWnT3 = I18NUtil::getUri(); goto NwjvZ; vEmVk: do_action("\143\x61\x63\150\x65\137\x61\x66\164\x65\162\137\141\x75\164\x6f\x6d\141\x74\151\x63\x5f\x63\x61\x63\150\x65\x5f\160\165\162\x67\x65", $HC3jy, $CVKvJ); goto A4KrT; Fy2WH: if (is_array($BWnT3)) { goto aP6BG; } goto H2N9L; kOBQd: $CVKvJ = ["\154\151\146\x65\163\x70\141\x6e" => $KkOdX, "\x66\x69\154\145\x5f\141\147\145\137\154\151\x6d\x69\164" => $HJNmz]; goto vEmVk; O22mI: $BWnT3 = $this->applyFilters("\143\x61\143\x68\x65\x5f\x61\x75\x74\157\x6d\141\164\151\143\137\x63\141\143\150\x65\137\x70\x75\162\x67\145\x5f\x75\162\x6c\x73", $BWnT3, $HJNmz); goto Fy2WH; c0mSy: $BWnT3 = array_filter($BWnT3, "\x69\x73\137\x73\x74\x72\151\x6e\147"); goto wULZ0; MHBgX: JXEIz: goto SslQI; irjIE: aP6BG: goto c0mSy; MmiF3: DvZjh: goto kOBQd; CGbem: if (!$BWnT3) { goto xEN0E; } goto fEyOS; NwjvZ: $HJNmz = time() - $KkOdX; goto O22mI; oaJUO: if (!$KkOdX) { goto JXEIz; } goto hMMnw; XbVbk: $XvAIE = Buffer::canGenerateCachingFiles(); goto vwaN2; wULZ0: $BWnT3 = array_filter($BWnT3); goto CGbem; vwaN2: foreach ($BWnT3 as $hgTz4) { goto lKkRn; MA9Lq: if (!$dxNRn) { goto fM4Th; } goto eCiox; ra1MC: KyoOc: goto JJuQ6; J0RMN: ltWv8: goto mNlgj; aTwjz: $KWSCi = $this->getCacheFilesInDir($wpkb5); goto tiDT3; eCiox: $HC3jy = array_merge($HC3jy, $dxNRn); goto oZ203; yV4iR: if (!$this->applyFilters("\x6f\160\164\151\x6d\151\172\141\x74\x69\157\156\137\x75\162\154\x5f\x6e\157\137\x64\157\x74\163", false)) { goto vFGR8; } goto rkSZZ; nNgFf: vFGR8: goto Evgch; QTCal: FQwxz: goto MA9Lq; mNlgj: $CVKvJ = ["\165\x72\154" => $hgTz4, "\x6c\x69\x66\145\x73\x70\x61\156" => $KkOdX, "\x66\151\x6c\145\137\x61\x67\x65\x5f\x6c\x69\x6d\x69\x74" => $HJNmz]; goto oVxkN; g6Em2: if (!$XvAIE) { goto ltWv8; } goto EHh_3; DUCon: $dxNRn = []; goto g6Em2; oZ203: fM4Th: goto J0RMN; lKkRn: do_action("\143\x61\143\150\145\137\142\145\x66\x6f\162\145\x5f\141\x75\x74\157\155\x61\x74\151\x63\137\x63\x61\x63\150\x65\x5f\x70\165\x72\x67\145\x5f\144\151\x72", $hgTz4, $HJNmz); goto DUCon; rkSZZ: $wpkb5["\x68\x6f\x73\x74"] = str_replace("\x2e", "\137", $wpkb5["\x68\x6f\163\x74"]); goto nNgFf; tiDT3: foreach ($KWSCi as $kJMVe) { goto UUDST; SCFA8: OOCuI: goto gYaGT; gYaGT: if (!$this->isDirectoryEmpty($yr2qb)) { goto RoZun; } goto VExSo; pT8a0: RoZun: goto asL3g; TvXSE: $dxNRn[] = ["\150\x6f\155\145\137\x75\x72\x6c" => $hgTz4, "\x68\x6f\155\x65\x5f\x70\x61\164\x68" => $QezH8, "\x6c\157\x67\x67\145\x64\x5f\x69\x6e" => $yr2qb !== $this->getPath() . $wpkb5["\150\x6f\x73\x74"], "\x66\151\154\x65\x73" => $ueLJI]; goto SCFA8; VExSo: getFilesystem()::remove($yr2qb); goto pT8a0; XeW0f: $QezH8 = $yr2qb . $Y8kin; goto HkMXc; HkMXc: $ueLJI = $this->purgeDirectory($QezH8, $HJNmz); goto Bf8_1; UUDST: $yr2qb = $kJMVe->getPathname(); goto XeW0f; Bf8_1: if (!$ueLJI) { goto OOCuI; } goto TvXSE; asL3g: g4eKs: goto hJ_sO; hJ_sO: } goto QTCal; oVxkN: do_action("\x63\141\x63\x68\145\137\141\146\164\145\x72\x5f\141\x75\164\x6f\155\141\x74\x69\x63\137\143\141\143\150\145\x5f\x70\165\x72\147\x65\x5f\x64\x69\x72", $dxNRn, $CVKvJ); goto ra1MC; Evgch: $Y8kin = rtrim($wpkb5["\x70\x61\x74\x68"], "\x2f"); goto aTwjz; EHh_3: $wpkb5 = FormatUtil::getParseUrl($hgTz4); goto yV4iR; JJuQ6: } goto MmiF3; rHLAD: $HC3jy = []; goto XbVbk; fEyOS: $BWnT3 = array_unique($BWnT3); goto rHLAD; SslQI: } private function purgeDirectory($GuTuU, $HJNmz) { goto hN7bp; pVQNj: $T1d9t = Util::getIterator($GuTuU); goto CXzfK; qsM6T: hk0Cb: goto i5PN_; hN7bp: $HC3jy = []; goto pVQNj; CXzfK: foreach ($T1d9t as $kJMVe) { goto W5Y_I; EnwPQ: goto ruMFl; goto rXQDV; Xmrzl: $GuTuU = dirname($D2KXr); goto R13rL; W5Y_I: if (!$kJMVe->isDot()) { goto TI4V7; } goto U1JHQ; u4UsR: if ($kJMVe->isFile() && $kJMVe->getCTime() < $HJNmz) { goto aUJJw; } goto Pom_h; t5Ij_: goto k133y; goto M8Azs; M8Azs: i8j9_: goto Xmrzl; R13rL: if (in_array($GuTuU, $HC3jy, true)) { goto wFEhF; } goto Me6_H; YWQuw: ruMFl: goto X4Ioy; oGCje: $HC3jy = array_merge($HC3jy, $Nbfw8); goto EnwPQ; nQdwR: $D2KXr = $kJMVe->getPathname(); goto qq3w_; rXQDV: aUJJw: goto nQdwR; XMuCN: wFEhF: goto YWQuw; X4Ioy: k133y: goto kUwqK; Me6_H: $HC3jy[] = $GuTuU; goto XMuCN; RaMts: if ($kJMVe->isDir()) { goto SRslF; } goto u4UsR; qq3w_: if (getFilesystem()::remove($D2KXr)) { goto i8j9_; } goto t5Ij_; MXcRC: TI4V7: goto RaMts; Pom_h: goto ruMFl; goto FkABw; FkABw: SRslF: goto syb3j; syb3j: $Nbfw8 = $this->purgeDirectory($kJMVe->getPathname(), $HJNmz); goto oGCje; U1JHQ: goto k133y; goto MXcRC; kUwqK: } goto qsM6T; i5PN_: if (!$this->isDirectoryEmpty($GuTuU)) { goto KlNKz; } goto c23B2; c23B2: getFilesystem()::remove($GuTuU); goto iZnxX; iZnxX: KlNKz: goto Wlr3h; Wlr3h: return $HC3jy; goto JClcL; JClcL: } }
