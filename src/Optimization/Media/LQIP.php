<?php
 namespace Optimization\Media; use Boilerplate\DOMCrawler; use Boilerplate\Util\ArrayUtil; use Boilerplate\Util\PostUtil; use Boilerplate\Util\ThemeUtil; use DOMElement; class LQIP extends Common { const IMAGE_SIZE = "\x6c\x71\x69\160\137\163\x69\172\x65"; const ATTACHMENT_META = "\157\160\x74\x69\x6d\x69\172\141\164\151\157\x6e\137\x6d\x65\144\x69\x61\x5f\154\161\x69\160\x5f\x6d\145\x74\x61\144\x61\164\x61"; public function addActions() : self { $this->addAction("\x61\146\164\x65\162\137\163\145\164\165\160\x5f\164\x68\145\x6d\x65", [$this, "\x61\144\x64\111\155\141\x67\x65\123\x69\172\x65"], 0, 9999); return parent::addActions(); } public function addFilters() : self { $this->addFilter("\x68\145\141\x64\x65\x72\137\x68\145\141\144\x5f\x73\x74\171\x6c\145\x73", [$this, "\141\144\x64\123\164\x79\x6c\x65\163"], 1, 99)->addFilter("\167\x70\x5f\147\145\x6e\x65\162\141\x74\145\137\x61\x74\x74\141\x63\150\x6d\145\156\164\x5f\x6d\145\x74\x61\144\x61\x74\141", [$this, "\147\145\156\145\x72\141\x74\145"], 2, 10)->addFilter("\x6f\x70\164\x69\x6d\x69\x7a\x61\164\x69\157\x6e\x5f\142\165\146\146\x65\x72\x5f\160\162\x6f\143\145\x73\x73", [$this, "\141\x64\144\x50\154\x61\x63\145\150\157\x6c\x64\145\162\124\157\x49\x6d\141\147\145\x73"], 1, 20)->addFilter("\157\160\x74\x69\155\x69\172\141\x74\151\x6f\156\x5f\x62\x75\x66\146\145\x72\137\156\x6f\x74\137\160\162\x6f\x63\145\163\x73\145\x64", [$this, "\x61\144\x64\x50\x6c\x61\x63\145\150\157\154\x64\145\x72\x54\x6f\111\x6d\141\147\x65\163"], 1, 20); return parent::addFilters(); } public function addImageSize() { add_image_size(self::IMAGE_SIZE, 30, 20); } public function addStyles($QHtFv) { $QHtFv .= $this->renderTwigTemplate("\x73\x74\171\x6c\x65\x73\x2e\x63\x73\163"); return $QHtFv; } public function addPlaceholderToImages($vwY7Y) { $vwY7Y = preg_replace_callback("\x2f\x3c\x69\155\x67\56\52\x3f\133\x5e\134\76\135\53\76\57", function ($upoja) { goto GHKKH; vm7Bj: $Lh3fh = DOMCrawler::getAttributes($nQqAP, "\x69\x6d\147"); goto h3V9E; BJ3HI: if (!($Q6Bxn && wp_attachment_is_image($Q6Bxn))) { goto KvVPB; } goto aly6U; C21dE: $eQ9Gc = ArrayUtil::get($Lh3fh, "\x77\151\144\164\x68", 0); goto AEKwF; hgt_x: if (!$nQqAP) { goto Mxy_H; } goto vm7Bj; G4pHY: $qLxZn = ThemeUtil::generateElement("\163\160\x61\x6e", ["\163\x74\171\154\x65" => "\x62\141\143\x6b\147\x72\x6f\165\156\144\55\x69\155\x61\x67\145\x3a\x20\x75\162\x6c\50\47{$qLxZn}\x27\x29\x3b", "\143\x6c\x61\x73\x73" => trim("\142\x67\55\x63\x6f\x76\x65\162\40\x6f\x70\141\143\x69\x74\x79\x2d\x74\x72\141\x6e\163\151\x74\x69\157\156\40\151\155\x67\x2d\142\154\165\162\40\167\x2d\x31\60\60\40\x68\55\61\60\x30")]); goto Sm4g9; jj_wT: if (!$qLxZn) { goto Rz3Xx; } goto G4pHY; ZU_tV: Rz3Xx: goto TaRh_; AEKwF: $nQqAP = ThemeUtil::generateElement("\x64\x69\x76", ["\x63\x6c\x61\163\x73" => "\160\x6c\141\143\x65\x68\157\x6c\144\x65\162\55\143\157\156\x74\141\151\156\x65\x72", "\163\x74\171\x6c\x65" => "\x6d\x69\x6e\55\x77\151\x64\x74\150\x3a\x20{$eQ9Gc}\160\x78"], true, [$nQqAP, $qLxZn]); goto ZU_tV; TaRh_: KvVPB: goto cSvok; ifRaW: return $nQqAP; goto FqxRQ; aly6U: $qLxZn = PostUtil::getMeta(self::ATTACHMENT_META, true, $Q6Bxn); goto jj_wT; cSvok: Mxy_H: goto ifRaW; Sm4g9: $nQqAP = DOMCrawler::addAttribute($nQqAP, ["\x69\x6d\x67" => ["\x63\154\141\x73\163" => "\157\x70\141\x63\151\x74\171\55\164\x72\x61\156\x73\x69\164\151\157\156"]]); goto C21dE; h3V9E: $Q6Bxn = ArrayUtil::get($Lh3fh, "\x64\141\x74\x61\55\x69\144"); goto BJ3HI; GHKKH: $nQqAP = ArrayUtil::get($upoja, 0); goto hgt_x; FqxRQ: }, $vwY7Y); return $vwY7Y; } public function generate($EaiGQ, $KcXuZ) { goto TMc1H; TMc1H: $Lu_9j = ArrayUtil::get($EaiGQ, "\x66\x69\154\145"); goto dDeXC; d2ios: $w5tII = ArrayUtil::getByPath($EaiGQ, "\163\151\172\x65\x73\x2e" . self::IMAGE_SIZE . "\56\155\151\155\145\x2d\x74\171\x70\x65"); goto lN5Sp; lN5Sp: $oZEcq = "\x64\x61\164\x61\72\x69\155\x61\x67\145\57{$w5tII}\73\x62\x61\163\145\x36\64\x2c" . base64_encode($this->getFilesystem()->getContent($wpkb5)); goto YQ6IF; MnfEG: if (!$this->getFilesystem()->exists($wpkb5)) { goto Zb_kA; } goto d2ios; I0YFR: $wpkb5 = str_replace(basename($Lu_9j), $EOJKs, get_attached_file($KcXuZ)); goto MnfEG; dDeXC: $EOJKs = ArrayUtil::getByPath($EaiGQ, "\163\151\x7a\x65\163\56" . self::IMAGE_SIZE . "\x2e\x66\151\x6c\x65"); goto EHlPJ; V8avd: Zb_kA: goto cO0dv; dTHBM: nNx9Z: goto V8avd; YQ6IF: if (!$oZEcq) { goto nNx9Z; } goto iZitP; EHlPJ: if (!($EOJKs && $Lu_9j)) { goto LZyRJ; } goto I0YFR; cO0dv: LZyRJ: goto T8cxC; iZitP: PostUtil::addMeta(self::ATTACHMENT_META, $oZEcq, $KcXuZ); goto dTHBM; T8cxC: return $EaiGQ; goto jG2Up; jG2Up: } }
