<?php
 namespace Optimization\Media; use Boilerplate\DOMCrawler; use DOMElement; class LazyLoad extends Common { const LAZY_LOAD_PATTERN = array("\x73\162\143" => "\144\141\164\141\55\163\162\143", "\x73\151\172\x65\x73" => "\x64\x61\164\x61\x2d\x73\x69\172\x65\163", "\x73\162\x63\163\145\x74" => "\x64\x61\x74\x61\x2d\163\x72\x63\x73\145\x74"); public function addFilters() : self { $this->addFilter("\154\141\172\171\x5f\x6c\x6f\141\144\x5f\145\x6e\x61\142\154\x65", "\137\137\x72\145\164\x75\x72\x6e\137\x74\162\x75\x65")->addFilter("\167\x70\x5f\154\141\172\x79\137\x6c\157\141\144\x69\156\147\x5f\145\156\x61\142\x6c\145\144", "\137\x5f\162\x65\164\x75\162\x6e\137\164\162\165\145")->addFilter("\x6f\160\x74\x69\x6d\151\172\x61\164\151\157\x6e\137\x62\x75\x66\x66\x65\162\137\160\x72\157\143\x65\x73\x73", [$this, "\154\x61\x7a\x79\114\157\x61\144\x48\164\x6d\154\x49\155\141\147\145\163"], 1, 15)->addFilter("\x6f\x70\164\151\155\151\x7a\x61\x74\x69\x6f\x6e\137\x62\x75\x66\146\145\162\137\x6e\x6f\164\137\160\x72\x6f\x63\x65\163\163\145\x64", [$this, "\x6c\141\x7a\x79\x4c\x6f\x61\x64\110\x74\x6d\x6c\111\155\141\147\145\163"], 1, 15)->addFilter("\142\x6f\151\154\145\162\x70\x6c\x61\x74\x65\x5f\141\163\163\145\x74\137\151\x6e\x6c\x69\x6e\x65\137\152\x61\x76\141\x73\x63\x72\x69\160\x74", [$this, "\141\x64\144\111\156\x6c\151\156\x65\x53\143\x72\151\160\x74\163"], 1, 99); return parent::addFilters(); } public function isAllow() { return $this->applyFilters("\x6f\160\x74\x69\x6d\151\172\x61\x74\x69\157\156\137\x6c\x61\172\171\x5f\x6c\157\141\x64\137\143\x61\156\137\x70\162\x6f\x63\x65\x73\x73", true); } public function addInlineScripts($scripts = array()) { goto oyBN1; oyBN1: $lazyLoadJs = $this->renderTwigTemplate("\151\x6e\x6c\151\x6e\145\x2e\152\x73"); goto Fo8l3; RXvGL: $scripts[] = $lazyLoadJs; goto o8r2G; SHmav: return $scripts; goto GOCbn; Fo8l3: if (!$lazyLoadJs) { goto V7Op_; } goto RXvGL; o8r2G: V7Op_: goto SHmav; GOCbn: } public function lazyLoadHtmlImages($buffer) { goto M26FT; M26FT: if (!($buffer && $this->isAllow())) { goto Q8jxu; } goto ncfYq; HcTT_: return $buffer; goto cUNAL; ywbxc: Uk45x: goto zUhuX; iMSSd: $buffer = DOMCrawler::elementsMap($buffer, $selector, function (DOMElement $node) { goto bbpK8; bbpK8: $value = $node->getAttribute("\x73\164\x79\x6c\x65"); goto vhrC3; G7wa8: $node->removeAttribute("\x73\x74\x79\154\145"); goto gz1MN; vhrC3: if (!$value) { goto GsY0d; } goto yl5dW; yl5dW: $node->setAttribute("\144\141\164\141\55\x73\x74\x79\x6c\145", $value); goto J2cUk; gz1MN: return $this->addLazyLoadClass($node); goto lQnG4; J2cUk: GsY0d: goto G7wa8; lQnG4: }); goto qwtig; HFq2w: $buffer = DOMCrawler::elementsMap($buffer, $selector, function (DOMElement $node) { goto VQJGe; kFPBw: YpCaI: goto e_fmp; VQJGe: foreach (self::LAZY_LOAD_PATTERN as $old => $new) { goto YpjXQ; jguPT: if ($old === "\x73\162\143") { goto zR3eG; } goto qxlMD; YpjXQ: $value = $node->getAttribute($old); goto e18LD; Uawv7: LdiXZ: goto jguPT; qGRPE: nKKpV: goto x69Vl; jXnGK: efG40: goto qGRPE; WL40k: $node->setAttribute($new, $value); goto Uawv7; e18LD: if (!$value) { goto LdiXZ; } goto WL40k; UKcJ0: zR3eG: goto Wjvk4; VtaKr: goto efG40; goto UKcJ0; OUtZa: $attachment = $node->getAttribute("\x64\x61\x74\141\55\x69\144"); goto FTWmt; qxlMD: $node->removeAttribute($old); goto VtaKr; FTWmt: $placeholder = $this->applyFilters("\157\160\164\x69\x6d\x69\172\x61\x74\151\x6f\156\137\x6d\145\x64\x69\141\137\154\x61\172\x79\x5f\154\x6f\141\144\137\160\154\141\143\x65\x68\x6f\x6c\144\145\162", '', $attachment, $attrs); goto KfDbW; Wjvk4: $attrs = DOMCrawler::getNodeAttributes($node); goto OUtZa; KfDbW: $node->setAttribute($old, $placeholder); goto jXnGK; x69Vl: } goto kFPBw; e_fmp: return $this->addLazyLoadClass($node); goto mVUCm; mVUCm: }, false, true); goto ywbxc; E5VId: Q8jxu: goto HcTT_; H9CrK: if (!DOMCrawler::has($buffer, $selector)) { goto Aedmo; } goto iMSSd; qwtig: Aedmo: goto E5VId; ncfYq: $selector = "\151\155\x67"; goto DQNNM; zUhuX: $selector = "\x5b\x73\x74\171\154\x65\135"; goto H9CrK; DQNNM: if (!DOMCrawler::has($buffer, $selector)) { goto Uk45x; } goto HFq2w; cUNAL: } public function addLazyLoadClass(DOMElement $node) { goto Fmf58; UWgMj: return $node; goto g8Ljn; vrGjt: $node->setAttribute("\143\x6c\x61\163\163", rtrim($class)); goto UWgMj; D0HBZ: $class .= "\40\154\x61\172\171\x6c\x6f\141\x64"; goto vrGjt; Fmf58: $class = $node->getAttribute("\x63\x6c\x61\163\x73"); goto D0HBZ; g8Ljn: } }
