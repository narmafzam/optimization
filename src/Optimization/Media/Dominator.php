<?php
 namespace Optimization\Media; use Boilerplate\Form\Form; use Boilerplate\Util\ArrayUtil; use Boilerplate\Util\CommonUtil; use Boilerplate\Util\PostUtil; use Boilerplate\Util\ThemeUtil; use ColorThief\ColorThief; use Exception; class Dominator extends Common { const DOMINATE_HEX_META = "\x64\157\155\151\x6e\x61\x74\x65\x5f\x68\x65\x78"; const DOMINATE_OVERRIDE_META = "\144\157\x6d\151\x6e\141\x74\145\x5f\157\x76\x65\x72\x72\x69\x64\145"; const DOMINATE_PLATTE_HEX_META = "\143\x6f\154\157\x72\137\x70\154\x61\164\x74\x65\137\150\x65\170"; public function __construct() { goto ARKlr; J4FCD: v6RUm: goto imcbD; b2GVi: parent::__construct(); goto J4FCD; ARKlr: if (!extension_loaded("\107\x44")) { goto v6RUm; } goto b2GVi; imcbD: } public function addActions() : self { $this->addAction("\141\144\144\x5f\141\x74\x74\141\x63\x68\x6d\145\x6e\164", [$this, "\165\160\144\141\x74\x65\x43\157\x6c\157\x72\104\x6f\x6d\x69\x6e\x61\156\143\145"]); return parent::addActions(); } public function addFilters() : self { $this->addFilter("\141\164\164\141\x63\x68\155\145\x6e\x74\137\x66\151\145\154\144\163\x5f\164\157\x5f\x73\141\166\145", [$this, "\x73\x61\166\x65\106\x69\145\x6c\144"])->addFilter("\141\x74\x74\x61\143\x68\155\145\x6e\164\x5f\146\151\x65\x6c\144\x73\x5f\x74\157\137\145\x64\x69\164", [$this, "\x61\x64\x64\106\x69\145\154\144"], 3)->addFilter("\157\160\164\x69\x6d\151\x7a\141\164\x69\x6f\x6e\x5f\155\145\144\x69\x61\137\154\141\172\171\x5f\154\x6f\141\144\x5f\160\x6c\141\143\145\x68\157\154\x64\145\x72", [$this, "\147\145\x74\x50\x6c\141\x63\145\150\x6f\x6c\x64\145\x72"], 3, 99); return parent::addFilters(); } public function getPlaceholder($qLxZn, $KcXuZ = null, $CArB4 = array()) { goto VXdVs; dsziE: $GvXzJ = str_replace("\x23", '', $GvXzJ); goto OTCqc; OTCqc: return "\x64\141\164\141\72\x69\x6d\141\147\x65\57\163\x76\147\53\170\155\x6c\x3b\x63\x68\141\162\x73\145\x74\75\125\x54\106\x2d\x38\x2c\x25\63\x43\x73\x76\147\x25\62\x30\x78\155\154\156\163\x25\63\104\45\x32\62\150\x74\164\160\45\x33\x41\45\x32\x46\45\x32\106\167\167\x77\x2e\x77\x33\x2e\157\162\147\45\62\x46\62\x30\60\60\45\62\x46\163\x76\x67\x25\x32\62\45\62\x30\x77\x69\x64\x74\150\x25\63\x44\x25\x32\62{$eQ9Gc}\45\x32\x32\x25\62\60\x68\145\x69\x67\x68\164\x25\63\104\x25\x32\x32{$FSmib}\45\62\62\x25\x32\x30\166\x69\145\x77\102\x6f\x78\x25\63\104\45\x32\62\x30\x25\62\60\60\x25\62\x30{$eQ9Gc}\45\x32\60{$FSmib}\45\62\x32\45\x33\x45\x25\x33\x43\162\145\143\x74\x25\x32\x30\146\x69\154\x6c\x25\x33\x44\45\62\62\45\62\x33{$GvXzJ}\x25\x32\x32\45\x32\60\167\151\144\164\x68\x25\63\104\45\62\62{$eQ9Gc}\x25\x32\x32\45\62\x30\150\x65\x69\x67\x68\164\45\63\x44\45\x32\x32{$FSmib}\x25\62\62\45\x32\x46\45\x33\x45\x25\63\103\45\62\106\x73\x76\x67\x25\63\x45"; goto Ejy9p; VXdVs: $GvXzJ = $this->srcColor("\43\60\67\x35\67\71\70", $KcXuZ); goto l6Yii; IgR7t: x59gQ: goto iFI3H; l6Yii: $eQ9Gc = ArrayUtil::get($CArB4, "\167\x69\144\164\150"); goto ee5sl; k4jeV: igbB4: goto dsziE; iFI3H: if ($eQ9Gc) { goto igbB4; } goto Q4jAN; Q4jAN: $eQ9Gc = $FSmib = 100; goto k4jeV; JymcA: $eQ9Gc = ArrayUtil::get($CArB4, "\144\x61\x74\141\55\x77\151\144\x74\150"); goto cKU_5; ee5sl: $FSmib = ArrayUtil::get($CArB4, "\150\x65\151\147\x68\164"); goto fJ_v5; fJ_v5: if ($eQ9Gc) { goto x59gQ; } goto JymcA; cKU_5: $FSmib = ArrayUtil::get($CArB4, "\144\141\x74\x61\55\x68\x65\151\x67\150\164"); goto IgR7t; Ejy9p: } public function srcColor($GvXzJ, $XIX7X = null) { goto vJpCd; rikq5: $GvXzJ = $C2GnT; goto vjcpW; FVo2p: if (!$C2GnT) { goto a0SqI; } goto rikq5; Nae2I: return $GvXzJ; goto t0izd; eFv_8: $KcXuZ = $XIX7X; goto KtKdg; wNFsu: if (!$XIX7X) { goto s46sz; } goto IunJR; KtKdg: goto BPtVP; goto DSdQ0; BDn03: $KcXuZ = PostUtil::getFeatureImageAttachment($XIX7X); goto jAHi0; csSPH: $C2GnT = PostUtil::getMeta(self::DOMINATE_HEX_META, true, $KcXuZ); goto FVo2p; vJpCd: $XIX7X = PostUtil::get($XIX7X, PostUtil::OBJECT, true); goto wNFsu; Nx15B: s46sz: goto Nae2I; DSdQ0: R0evm: goto BDn03; IunJR: if (PostUtil::getType($XIX7X) !== "\141\x74\164\x61\143\150\155\145\x6e\164") { goto R0evm; } goto eFv_8; jAHi0: BPtVP: goto csSPH; vjcpW: a0SqI: goto Nx15B; t0izd: } public function rgb2hex($lh0OS) { goto qKO8x; FZQMC: $C2GnT .= str_pad(dechex($lh0OS[1]), 2, "\60", STR_PAD_LEFT); goto hQMJl; D4crY: $C2GnT .= "\105\71\x45\x39\x45\71"; goto BI3pF; i12CB: ZyCxl: goto sKJg6; qKO8x: $C2GnT = "\43"; goto a2J1U; sKJg6: return $C2GnT; goto g88Lr; Ac9Tg: ocQ4r: goto u6eTZ; BI3pF: goto ZyCxl; goto Ac9Tg; hQMJl: $C2GnT .= str_pad(dechex($lh0OS[2]), 2, "\x30", STR_PAD_LEFT); goto i12CB; a2J1U: if (is_array($lh0OS) && count($lh0OS) == 3) { goto ocQ4r; } goto D4crY; u6eTZ: $C2GnT .= str_pad(dechex($lh0OS[0]), 2, "\60", STR_PAD_LEFT); goto FZQMC; g88Lr: } public function updateColorDominance($KcXuZ) { goto gV7mh; z1aai: $lzMAN = wp_upload_dir(); goto DTMG8; prfXT: DMcVU: goto feb85; feb85: TWZm6: goto lLwqH; tvNml: if (!$nQqAP) { goto DMcVU; } goto atVFB; DTMG8: $nQqAP = "{$lzMAN["\x62\141\163\145\x64\151\162"]}\57" . PostUtil::getMeta("\x5f\167\160\x5f\141\164\164\141\x63\x68\145\x64\x5f\x66\151\x6c\x65", true, $KcXuZ); goto tvNml; atVFB: try { goto AdXaG; k6cEM: PostUtil::updateMeta(self::DOMINATE_PLATTE_HEX_META, $N34ee, $KcXuZ); goto aYOcV; mH8XM: if (!$GvXzJ) { goto TC5Nx; } goto hM2ZZ; AdXaG: $GvXzJ = ColorThief::getColor($nQqAP); goto mH8XM; PjwPx: $N34ee = []; goto YfVI_; HV77V: $h0Nf_ = ColorThief::getPalette($nQqAP, 8); goto PjwPx; hM2ZZ: $C2GnT = $this->rgb2hex($GvXzJ); goto HC3s4; aYOcV: TC5Nx: goto lzkzp; rwcIe: z9Xsy: goto k6cEM; HC3s4: PostUtil::updateMeta(self::DOMINATE_HEX_META, $C2GnT, $KcXuZ); goto HV77V; YfVI_: foreach ($h0Nf_ as $lh0OS) { $N34ee[] = $this->rgb2hex($lh0OS); YGzXg: } goto rwcIe; lzkzp: } catch (Exception $Vggs0) { } goto prfXT; gV7mh: if (!wp_attachment_is_image(PostUtil::getId($KcXuZ))) { goto TWZm6; } goto z1aai; lLwqH: } public function addField($VQAqe, $KcXuZ) { goto XYBm3; B53Ye: fnYpA: goto ACiZh; ACiZh: return $VQAqe; goto lyutM; RsYH3: if (!$JZhrh) { goto eqV8u; } goto xdroL; ENqnz: zTYJ2: goto fZhPv; wCEw0: $JZhrh = PostUtil::getMeta(self::DOMINATE_PLATTE_HEX_META, true, $KcXuZ); goto RsYH3; xdroL: $hDXmd = []; goto Hvlj6; jP6W2: eqV8u: goto l9EDm; XYBm3: if (!$this->notSvg($KcXuZ)) { goto fnYpA; } goto wCEw0; l9EDm: $VQAqe[self::DOMINATE_OVERRIDE_META] = ["\151\156\x70\x75\x74" => "\x68\164\155\x6c", "\150\164\155\x6c" => Form::getFormElement()->renderFields([Form::getCheckboxField(self::DOMINATE_OVERRIDE_META, __("\116\x6f\40\x43\157\x6c\157\x72\40\x44\157\x6d\x69\x6e\141\156\x63\145\40\101\x76\141\151\x6c\141\x62\x6c\x65\x2e", OPTIMIZATION_DOMAIN))->setDesc(__("\103\150\x65\x63\153\40\x74\150\x69\x73\40\x69\164\x65\155\40\146\157\162\40\x67\x65\x6e\x65\x72\x61\x74\145\40\x64\157\155\x69\x6e\x61\164\x65\40\143\157\x6c\157\x72\163\x2e", OPTIMIZATION_DOMAIN))], false)]; goto e9xCu; fZhPv: $VQAqe[self::DOMINATE_HEX_META] = ["\x68\x74\155\x6c" => Form::getFormElement()->renderFields([Form::getRadioField(self::DOMINATE_HEX_META)->setOptions($hDXmd)->setDefault(PostUtil::getMeta(self::DOMINATE_HEX_META, true, $KcXuZ))->setInline(true)->addParentClass("\x64\x6f\x6d\151\156\x61\156\164\55\143\x6f\x6c\x6f\x72\163")], false), "\x69\x6e\x70\x75\164" => "\150\164\x6d\x6c", "\x6c\x61\142\145\x6c" => __("\x44\157\155\x69\x6e\x61\x6e\164\40\x43\157\x6c\157\x72", OPTIMIZATION_DOMAIN)]; goto Q4qq1; e9xCu: uNZ5v: goto B53Ye; Q4qq1: goto uNZ5v; goto jP6W2; Hvlj6: foreach ($JZhrh as $nzF0q => $GvXzJ) { $hDXmd[$GvXzJ] = ThemeUtil::generateElement("\163\160\141\156", ["\x73\164\x79\154\145" => "\x62\x61\x63\153\147\x72\x6f\165\156\144\55\143\x6f\x6c\157\x72\x3a\x20{$GvXzJ}\73", "\x63\x6c\x61\163\x73" => "\167\55\x31\60\x30"], true); EDMwP: } goto ENqnz; lyutM: } public function saveField($KcXuZ) { goto imO4L; BPTUI: w3K0N: goto IENGO; RTYPr: goto w3K0N; goto eYCJu; t85Ni: goto w3K0N; goto ArZrw; ArZrw: VbZJ5: goto zkoU6; IENGO: KzGf3: goto HyLLI; imO4L: if (!$this->notSvg($KcXuZ)) { goto KzGf3; } goto H9AGM; slgZg: $this->updateColorDominance($KcXuZ); goto t85Ni; RLQse: if ($C2GnT = CommonUtil::getRequest(self::DOMINATE_HEX_META, false)) { goto VbZJ5; } goto RTYPr; H9AGM: if (CommonUtil::getRequest(self::DOMINATE_OVERRIDE_META, false)) { goto Suky4; } goto RLQse; HyLLI: return $KcXuZ; goto TxaTu; eYCJu: Suky4: goto slgZg; zkoU6: PostUtil::updateMeta(self::DOMINATE_HEX_META, $C2GnT, $KcXuZ); goto BPTUI; TxaTu: } public function notSvg($KcXuZ) { return !$this->applyFilters("\141\164\164\x61\x63\150\x6d\x65\156\x74\137\x69\163\137\x73\166\x67", false, $KcXuZ); } }
