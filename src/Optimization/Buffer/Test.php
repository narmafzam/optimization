<?php
 namespace Optimization\Buffer; use Optimization\Traits\MemoizeTrait; class Test { use MemoizeTrait; protected array $post = []; protected array $get = []; protected ?Config $config = null; protected ?array $cookies = []; protected array $tests = ["\163\x73\x6c" => 1, "\x75\x72\x69" => 1, "\155\x6f\142\151\154\145" => 1, "\x77\x70\137\x34\x30\64" => 1, "\x73\x65\141\162\143\150" => 1, "\165\163\145\x72\137\x61\x67\145\x6e\x74" => 1, "\x71\165\145\162\x79\137\x73\x74\x72\x69\156\x67" => 1, "\x64\157\156\157\164\143\x61\143\x68\x65\x70\141\147\145" => 1, "\162\x65\152\145\x63\x74\145\x64\137\143\x6f\x6f\153\151\145" => 1, "\155\x61\x6e\x64\141\164\157\162\x79\137\143\157\x6f\x6b\151\x65" => 1]; private array $lastError = []; public function __construct(Config $config, array $args = []) { goto vUOM8; IUu8M: $this->cookies = $args["\143\x6f\x6f\153\x69\x65\163"] && is_array($args["\143\x6f\157\x6b\x69\145\x73"]) ? $args["\143\157\x6f\x6b\151\145\x73"] : []; goto ip7xM; QUby6: $this->setTest((array) $args["\164\x65\x73\x74"]); goto fBt8s; eDYdl: if ($args["\164\145\x73\x74"]) { goto bYuoj; } goto QUby6; vUOM8: $this->config = $config; goto zicWj; zicWj: $args = wp_parse_args($args, ["\x67\145\164" => is_array($_GET) && $_GET ? $_GET : [], "\x70\x6f\x73\x74" => is_array($_POST) && $_POST ? $_POST : [], "\164\145\x73\x74" => [], "\143\x6f\x6f\x6b\151\145\x73" => is_array($_COOKIE) && $_COOKIE ? $_COOKIE : []]); goto eDYdl; glSK_: $this->get = $args["\x67\145\x74"] && is_array($args["\147\x65\x74"]) ? $args["\x67\145\164"] : []; goto Oxivl; fBt8s: bYuoj: goto glSK_; uSXUV: $this->post = array_intersect_key($this->getPost(), ["\167\160\137\x63\x75\x73\x74\x6f\155\x69\x7a\145" => '']); goto lWLIh; ip7xM: if (!$this->getPost()) { goto a7iJo; } goto uSXUV; Oxivl: $this->post = $args["\x70\157\x73\x74"] && is_array($args["\x70\x6f\163\164"]) ? $args["\x70\157\163\164"] : []; goto IUu8M; lWLIh: a7iJo: goto so2iE; so2iE: } public function getConfig() : Config { return $this->config; } public function canInitProcess() { goto eCQK3; gXjM4: return $can; goto WiG2v; gsJ9K: $can = false; goto K2aaT; RGV7r: $can = false; goto YUQ_i; suq8Z: aWQ8L: goto L6pOu; D5yns: $can = false; goto g9vQZ; j9W1l: if ($this->isCustomizerPreview()) { goto aWQ8L; } goto CKTuJ; CKTuJ: if (!$this->isAllowedRequestMethod()) { goto nomK7; } goto N89Iv; Xvxxz: if ($this->hasTest("\x71\x75\x65\162\x79\x5f\x73\164\162\151\156\147") && !$this->canProcessQueryString()) { goto au7em; } goto fXdvX; GtLQK: au7em: goto rwNT2; g5u8l: if (!isset($config["\163\165\143\x63\145\x73\x73"]) || !$config["\x73\165\x63\x63\145\163\163"]) { goto AQgT_; } goto Xvxxz; k6WXa: $this->setError("\x50\x48\120\x2c\x20\x58\115\114\x2c\x20\157\162\40\x58\x53\x4c\40\146\151\154\x65\x20\x69\x73\40\x65\x78\143\154\165\x64\x65\144\x2e"); goto fgLSe; yc3hE: goto hS3Vp; goto Ci4IX; N89Iv: if ($this->hasTest()) { goto I991q; } goto kNK61; YjTxz: $can = false; goto E8Hwh; ljN3a: $can = false; goto BF2D2; irf09: $this->setError("\x52\145\x71\165\145\x73\164\40\x6d\x65\164\150\157\x64\40\151\163\40\x6e\x6f\x74\x20\141\x6c\154\x6f\x77\x65\144\x2e\x20\x50\x61\147\145\40\x63\141\x6e\x6e\x6f\164\x20\x62\145\40\143\141\x63\150\x65\144\56", ["\x72\x65\161\165\x65\163\164\x5f\155\145\x74\x68\x6f\x64" => $this->getRequestMethod()]); goto D8jua; MNIQe: goto lzTN6; goto UBzes; iES24: if ($this->isAdmin()) { goto ugEaM; } goto j9W1l; YfsAQ: $this->setError("\105\170\143\154\165\144\145\144\x20\x63\157\157\x6b\151\145\x20\146\157\165\x6e\x64\x2e", ["\145\170\143\154\x75\144\145\x64\x5f\143\157\157\x6b\151\145\163" => $this->hasRejectedCookie()]); goto RGV7r; E8Hwh: goto hS3Vp; goto Pusrc; RAxCZ: $this->setError("\x55\x73\145\162\40\x41\x67\145\156\164\40\x69\x73\x20\x65\x78\143\154\x75\144\x65\x64\56", ["\165\x73\x65\x72\137\141\147\x65\156\x74" => $this->getConfig()->getServerInput("\110\124\124\x50\x5f\x55\x53\105\x52\137\101\107\x45\116\x54")]); goto gsJ9K; K71iV: $can = false; goto yc3hE; EhW6V: jKq6u: goto niQzv; Xaxg5: AQP3b: goto k6WXa; ynYDA: HnbZn: goto Pdphk; sIbLz: nomK7: goto irf09; Pusrc: uW2m7: goto RAxCZ; OFTBH: if ($this->isRejectedFile()) { goto FKCns; } goto P8qxX; S7JjF: FKCns: goto H8q8W; p1yc4: $this->setError("\x4e\x6f\x20\x63\x6f\x6e\146\151\147\x20\x66\x69\154\145\x20\146\x6f\165\156\x64\x2e", ["\143\x6f\x6e\146\x69\147\137\x70\141\164\150" => $config["\x70\x61\164\150"]]); goto D67QD; kNK61: goto lzTN6; goto S7JjF; rwNT2: $this->setError("\121\165\145\x72\171\40\163\164\x72\x69\156\147\40\125\x52\114\40\151\163\x20\x65\x78\x63\x6c\x75\x64\145\144\56"); goto DXpkO; K2aaT: hS3Vp: goto YX88E; D67QD: $can = false; goto fQpqp; lxed8: $this->setError("\x41\x64\x6d\151\x6e\x20\157\162\x20\x41\x4a\101\x58\40\125\122\x4c\x20\151\163\x20\145\x78\x63\x6c\165\x64\x65\x64\56"); goto LwWQf; eCQK3: $can = true; goto OeTBr; UBzes: ugEaM: goto lxed8; eJDpU: if ($this->hasTest("\x75\x73\x65\162\137\x61\147\x65\156\164") && !$this->canProcessUserAgent()) { goto uW2m7; } goto M8HhY; YUQ_i: goto hS3Vp; goto ynYDA; P8qxX: if ($this->isRejectedExtension()) { goto AQP3b; } goto iES24; g9vQZ: goto hS3Vp; goto EhW6V; M8HhY: goto hS3Vp; goto b84b5; BVApj: goto lzTN6; goto sIbLz; fQpqp: goto hS3Vp; goto GtLQK; niQzv: $this->setError("\120\141\x67\x65\x20\x69\163\40\145\x78\x63\x6c\x75\144\x65\x64\56"); goto K71iV; b84b5: AQgT_: goto p1yc4; DppX6: goto lzTN6; goto nMCKE; YX88E: lzTN6: goto gXjM4; I2h3t: if ($this->hasTest("\165\162\x69") && !$this->canProcessUri()) { goto jKq6u; } goto HuO1g; Ci4IX: uLFrF: goto YfsAQ; L6pOu: $this->setError("\103\x75\163\x74\157\155\151\x7a\x65\x72\40\160\x72\145\x76\x69\145\x77\40\x69\x73\40\x65\x78\143\154\x75\144\145\144\56"); goto viMUX; fXdvX: if ($this->hasTest("\163\x73\x6c") && !$this->canProcessSSL()) { goto cQj5e; } goto I2h3t; O7goH: goto lzTN6; goto suq8Z; Pdphk: $this->setError("\x4d\151\163\163\151\156\147\40\155\141\156\x64\x61\x74\157\x72\x79\40\143\x6f\157\x6b\x69\145\x3a\x20\x70\141\147\x65\40\156\x6f\164\40\160\162\157\x63\145\x73\163\x65\144\56", ["\155\x69\163\163\x69\156\147\137\143\x6f\157\x6b\x69\x65\x73" => $this->hasMandatoryCookie()]); goto YjTxz; OeTBr: $this->lastError = []; goto OFTBH; D8jua: $can = false; goto DppX6; BF2D2: goto lzTN6; goto Xaxg5; LwWQf: $can = false; goto O7goH; viMUX: $can = false; goto BVApj; QJGrF: $config = $this->getConfig()->getConfigFilePath(); goto g5u8l; c6QBL: $this->setError("\x53\123\114\40\x63\141\143\x68\145\40\156\x6f\164\40\x61\160\x70\x6c\151\145\x64\x20\x74\157\x20\x70\141\x67\x65\x2e"); goto D5yns; fgLSe: $can = false; goto MNIQe; nMCKE: I991q: goto QJGrF; V0PUC: if ($this->hasTest("\155\141\x6e\x64\x61\164\157\162\x79\137\x63\x6f\x6f\x6b\151\145") && !$this->isSpeedTool() && is_array($this->hasMandatoryCookie())) { goto HnbZn; } goto eJDpU; DXpkO: $can = false; goto RV0cI; HuO1g: if ($this->hasTest("\x72\x65\152\145\143\x74\x65\144\x5f\143\157\x6f\x6b\x69\145") && $this->hasRejectedCookie()) { goto uLFrF; } goto V0PUC; hStsZ: cQj5e: goto c6QBL; RV0cI: goto hS3Vp; goto hStsZ; H8q8W: $this->setError("\122\157\142\157\x74\163\56\x74\x78\x74\40\157\162\x20\56\150\164\x61\143\x63\145\163\x73\x20\146\151\x6c\x65\x20\x69\163\x20\x65\x78\x63\x6c\x75\x64\x65\x64\56"); goto ljN3a; WiG2v: } public function canProcessBuffer(string $buffer) { goto cMsh8; vdamW: $can = false; goto iBy38; iBy38: goto DIwRL; goto BG14J; A7fgx: $this->setError("\x42\165\146\146\145\162\40\143\x6f\156\164\x65\156\164\40\165\156\x64\x65\162\x20\x32\65\x35\40\143\x61\162\141\143\164\x65\162\163\56\72\x20{$buffer}"); goto vdamW; RBG_G: $can = false; goto LMH0_; yE2T0: wEGH8: goto rkNb_; J2GTL: goto DIwRL; goto iSk0x; UZ1VA: goto DIwRL; goto yE2T0; cN4CN: goto DIwRL; goto lDeF1; sR_24: if (strlen($buffer) <= 255) { goto OaBHs; } goto CN0DC; cMsh8: $this->lastError = []; goto LE2F0; LMH0_: DIwRL: goto p22gE; K5oaZ: $this->setError("\127\x50\x20\x34\x30\x34\40\160\x61\147\x65\x20\x69\x73\40\x65\x78\143\154\x75\x64\145\x64\x2e"); goto Kw591; iSk0x: TEz1g: goto YCh0M; fHP1Y: if ($this->hasTest("\x77\160\137\x34\60\64") && $this->is404()) { goto IYIi6; } goto ddY_u; ddY_u: if ($this->hasTest("\x73\145\x61\162\143\150") && $this->isSearch()) { goto TEz1g; } goto y6p9H; Kw591: $can = false; goto J2GTL; CN0DC: if (http_response_code() !== 200) { goto C40Om; } goto LTIg7; FJept: $can = false; goto cN4CN; p22gE: return $can; goto LeOe_; G4GCE: $this->setError("\x50\x61\147\145\x20\x69\x73\x20\156\157\164\40\141\40\x32\x30\x30\x20\x48\124\x54\120\x20\162\x65\163\x70\157\x6e\163\145\x20\141\156\144\x20\143\141\156\156\x6f\x74\40\142\x65\40\x63\x61\143\x68\145\x64\x2e"); goto QKh7T; y6p9H: goto DIwRL; goto wnQr4; QKh7T: $can = false; goto UZ1VA; LTIg7: if ($this->hasTest("\144\157\156\x6f\164\143\141\143\150\x65\x70\141\x67\x65") && $this->hasDontCachePage()) { goto wEGH8; } goto fHP1Y; BG14J: C40Om: goto G4GCE; LE2F0: $can = true; goto sR_24; wnQr4: OaBHs: goto A7fgx; YCh0M: $this->setError("\x53\x65\x61\162\x63\150\40\x70\141\147\x65\40\151\163\40\145\170\143\154\x75\x64\x65\144\56"); goto RBG_G; lDeF1: IYIi6: goto K5oaZ; rkNb_: $this->setError("\x44\117\x4e\x4f\x54\103\x41\103\x48\105\x50\x41\107\x45\40\x69\x73\x20\144\145\146\x69\156\x65\144\x2e\40\120\x61\147\145\40\143\141\156\x6e\x6f\164\x20\142\x65\x20\143\x61\x63\150\x65\x64\56"); goto FJept; LeOe_: } public function getTests() : array { return $this->tests; } public function hasTest($name = '') { goto tYOQE; fJ_61: goto E4dHl; goto y9fj4; j2wUx: $has = isset($tests[$name]); goto fJ_61; tYOQE: $tests = $this->getTests(); goto PKqSC; PKqSC: if (!$name) { goto pgSOi; } goto j2wUx; QR5_S: E4dHl: goto wy1hv; y9fj4: pgSOi: goto F_aD6; wy1hv: return $has; goto S3eC3; F_aD6: $has = !empty($tests); goto QR5_S; S3eC3: } public function setTest(array $tests) { $tests = array_flip($tests); $this->tests = array_merge($this->getTests(), $tests); } public function isRejectedFile() { goto TkMWj; Nk4wi: YB6t1: goto FvEOy; lkpmF: return $this->getMemoizedBy(__FUNCTION__); goto Nk4wi; fn15U: foreach ($files as $file) { goto nu0hn; nu0hn: if (!(false !== strpos($requestUri, "\57" . $file))) { goto wwdy3; } goto a8qz8; a8qz8: return $this->memoize(__FUNCTION__, [], true); goto dsUeV; mXPIG: XSRXc: goto g0nQg; dsUeV: wwdy3: goto mXPIG; g0nQg: } goto DhLx8; TkMWj: if (!$this->isMemoized(__FUNCTION__)) { goto YB6t1; } goto lkpmF; DhLx8: izfCc: goto bvz77; RhBQx: UKFOW: goto dJLnq; Gb891: if ($requestUri) { goto UKFOW; } goto g415P; g415P: return $this->memoize(__FUNCTION__, [], false); goto RhBQx; dJLnq: $files = ["\x72\157\142\157\x74\163\56\x74\170\x74", "\x2e\150\x74\x61\143\x63\145\163\163"]; goto fn15U; bvz77: return $this->memoize(__FUNCTION__, [], false); goto UEJCo; FvEOy: $requestUri = $this->getRequestUriBase(); goto Gb891; UEJCo: } public function isRejectedExtension() { goto EQsEM; NhRSD: Ed_uv: goto RrVPi; n6wkm: if (!(strtolower($requestUri) === "\57\x69\x6e\x64\x65\x78\56\x70\x68\160")) { goto Ed_uv; } goto Iole1; oCVjx: return $this->memoize(__FUNCTION__, [], false); goto ey15K; bGrV6: if ($requestUri) { goto yXZp9; } goto oCVjx; VIcPG: vNX0t: goto rgK0a; Iole1: return $this->memoize(__FUNCTION__, [], false); goto NhRSD; RrVPi: $extension = pathinfo($requestUri, PATHINFO_EXTENSION); goto lKCOW; rgK0a: $requestUri = $this->getRequestUriBase(); goto bGrV6; ey15K: yXZp9: goto n6wkm; FmVXd: return $this->getMemoizedBy(__FUNCTION__); goto VIcPG; Kcc9t: $isRejected = $extension && isset($extensions[$extension]); goto Dk4Ny; EQsEM: if (!$this->isMemoized(__FUNCTION__)) { goto vNX0t; } goto FmVXd; lKCOW: $extensions = ["\x70\x68\160" => 1, "\x78\155\x6c" => 1, "\x78\x73\x6c" => 1]; goto Kcc9t; Dk4Ny: return $this->memoize(__FUNCTION__, [], $isRejected); goto xZjIp; xZjIp: } public function isAdmin() { return is_admin() || defined("\x44\117\111\116\x47\x5f\101\x4a\x41\130") && DOING_AJAX; } public function isCustomizerPreview() { return isset($this->getPost()["\167\x70\x5f\143\x75\163\x74\x6f\155\151\x7a\145"]); } public function isAllowedRequestMethod() { $allowed = ["\x47\105\124" => 1, "\x48\x45\x41\x44" => 1]; return isset($allowed[$this->getRequestMethod()]); } public function canProcessQueryString() { goto sO8tk; A_Hu2: if ($params) { goto wYRY7; } goto ZjLUU; ITSfx: return $this->memoize(__FUNCTION__, [], $can); goto uerfv; lQKvo: return $this->memoize(__FUNCTION__, [], false); goto sXfQM; ot5pN: if ($allowedParams) { goto ejYAP; } goto lQKvo; pl9mU: zDYAZ: goto zSQYh; O3hAO: return $this->getMemoizedBy(__FUNCTION__); goto Hsux2; hIcXX: return $this->memoize(__FUNCTION__, [], true); goto pl9mU; N6AJI: $allowedParams = ["\x6c\x61\156\147" => 1, "\x70\x65\162\155\141\x6c\x69\156\153\137\x6e\x61\155\x65" => 1, "\154\160\55\166\141\x72\x69\x61\x74\x69\157\156\55\x69\144" => 1]; goto PC9FG; y9kkW: $can = (bool) array_intersect_key($params, array_flip($allowedParams)); goto ITSfx; Hsux2: fgoU7: goto b9zbc; jsuLR: wYRY7: goto N6AJI; PC9FG: if (!array_intersect_key($params, $allowedParams)) { goto zDYAZ; } goto hIcXX; b9zbc: $params = $this->getQueryParams(); goto A_Hu2; ZjLUU: return $this->memoize(__FUNCTION__, [], true); goto jsuLR; sO8tk: if (!$this->isMemoized(__FUNCTION__)) { goto fgoU7; } goto O3hAO; zSQYh: $allowedParams = $this->getConfig()->get("\x63\141\x63\x68\145\137\161\165\x65\x72\171\137\x73\x74\x72\x69\x6e\147\x73"); goto ot5pN; sXfQM: ejYAP: goto y9kkW; uerfv: } public function canProcessSSL() { return !$this->isSSL() || $this->getConfig()->get("\143\x61\x63\150\x65\x5f\x73\163\x6c"); } public function canProcessUri() { goto bqko5; tsug8: if ($uri_pattern) { goto pU4Hz; } goto FyJby; TcYFD: $uri_pattern = $this->getConfig()->get("\143\x61\x63\x68\x65\x5f\x72\x65\152\145\143\x74\137\165\162\x69"); goto tsug8; xoNeB: pU4Hz: goto Mgfw5; bqko5: if (!$this->isMemoized(__FUNCTION__)) { goto BpGaj; } goto HyO08; FyJby: return $this->memoize(__FUNCTION__, [], true); goto xoNeB; Mgfw5: $can = !preg_match("\43\x5e\50" . $uri_pattern . "\x29\x24\43\151", $this->getCleanRequestUri()); goto GBXNo; hz9BQ: BpGaj: goto TcYFD; GBXNo: return $this->memoize(__FUNCTION__, [], $can); goto jiuT7; HyO08: return $this->getMemoizedBy(__FUNCTION__); goto hz9BQ; jiuT7: } public function hasRejectedCookie() { goto MqhCy; qaJC8: JPaKT: goto gGy0M; UPHr3: if (empty($excludedCookies)) { goto lpLVl; } goto GaAuZ; i0b3o: $rejectedCookies = $this->getConfig()->getRejectedCookies(); goto ia5Hb; baK9i: return $this->getMemoizedBy(__FUNCTION__); goto qaJC8; y2Ut_: if ($cookies) { goto jQza3; } goto FxAPH; gGy0M: $cookies = $this->getCookies(); goto y2Ut_; GaAuZ: return $this->memoize(__FUNCTION__, [], $excludedCookies); goto NgR5V; BFcUj: rqrSq: goto UPHr3; TvfVa: return $this->memoize(__FUNCTION__, [], false); goto kUKjt; DLBBl: $excludedCookies = []; goto FZcW3; xbfww: return $this->memoize(__FUNCTION__, [], false); goto zoHAZ; kUKjt: L081o: goto DLBBl; FxAPH: return $this->memoize(__FUNCTION__, [], false); goto lXyW4; NgR5V: lpLVl: goto xbfww; lXyW4: jQza3: goto i0b3o; MqhCy: if (!$this->isMemoized(__FUNCTION__)) { goto JPaKT; } goto baK9i; ia5Hb: if ($rejectedCookies) { goto L081o; } goto TvfVa; FZcW3: foreach (array_keys($cookies) as $cookie) { goto Rrxq6; v6Pkd: $excludedCookies[] = $cookie; goto UOg6x; Rrxq6: if (!preg_match($rejectedCookies, $cookie)) { goto RveLb; } goto v6Pkd; UOg6x: RveLb: goto G23MT; G23MT: y0LRP: goto diUqd; diUqd: } goto BFcUj; zoHAZ: } public function hasMandatoryCookie() { goto MJniH; qtoWd: return $this->memoize(__FUNCTION__, [], $missingCookies); goto nuSQc; gxXC5: return $this->getMemoizedBy(__FUNCTION__); goto o6Wmh; o6Wmh: LMhH2: goto QrTu5; rM3PO: $cookies = $this->getCookies(); goto W06OC; VpS_K: if ($mandatoryCookies) { goto KYIjd; } goto f70Gw; TseFP: return $this->memoize(__FUNCTION__, [], array_flip($missingCookies)); goto YyeT3; uzBbt: if ($cookies) { goto DktD3; } goto qtoWd; yPJA9: KYIjd: goto rM3PO; nuSQc: DktD3: goto EefgB; x72h0: return $this->memoize(__FUNCTION__, [], true); goto bKkDq; f70Gw: return $this->memoize(__FUNCTION__, [], true); goto yPJA9; W06OC: $missingCookies = array_flip(explode("\174", $this->getConfig()->get("\143\141\x63\150\x65\x5f\155\x61\x6e\x64\141\164\x6f\x72\171\137\143\157\x6f\x6b\151\145\163"))); goto uzBbt; EefgB: foreach (array_keys($cookies) as $cookie) { goto bmasL; BQikL: pxxWO: goto A8dN_; Jo7ke: unset($missingCookies[$cookie]); goto H0uX2; bmasL: if (!preg_match($mandatoryCookies, $cookie)) { goto oHAKj; } goto Jo7ke; H0uX2: oHAKj: goto BQikL; A8dN_: } goto s7vzm; rW7wi: if (!empty($missingCookies)) { goto dtCXy; } goto x72h0; s7vzm: nNXvA: goto rW7wi; QrTu5: $mandatoryCookies = $this->getConfig()->getMandatoryCookies(); goto VpS_K; bKkDq: dtCXy: goto TseFP; MJniH: if (!$this->isMemoized(__FUNCTION__)) { goto LMhH2; } goto gxXC5; YyeT3: } public function canProcessUserAgent() { goto cRtIb; RBh4H: $can = !preg_match("\43" . $rejectedUAs . "\43", $this->getConfig()->getServerInput("\x48\124\x54\x50\137\125\x53\x45\x52\x5f\x41\x47\x45\116\124")); goto upJUJ; Z7fva: if ($this->getConfig()->getServerInput("\110\124\124\120\137\x55\x53\x45\x52\137\101\x47\105\116\124")) { goto BIbBk; } goto DnuGY; hiOxU: if ($rejectedUAs) { goto ecwpi; } goto txmNc; hxqAN: ftPSz: goto Z7fva; VogCI: return $this->getMemoizedBy(__FUNCTION__); goto hxqAN; Jrjxz: ecwpi: goto RBh4H; MufFO: $rejectedUAs = $this->getConfig()->get("\143\141\x63\x68\145\x5f\162\145\x6a\x65\143\x74\137\165\x61"); goto hiOxU; DnuGY: return $this->memoize(__FUNCTION__, [], true); goto L6Aw6; L6Aw6: BIbBk: goto MufFO; upJUJ: return $this->memoize(__FUNCTION__, [], $can); goto aX3DN; txmNc: return $this->memoize(__FUNCTION__, [], true); goto Jrjxz; cRtIb: if (!$this->isMemoized(__FUNCTION__)) { goto ftPSz; } goto VogCI; aX3DN: } public function canProcessMobile() { goto uTcJl; uTcJl: if (!$this->isMemoized(__FUNCTION__)) { goto DlIz4; } goto T48ui; lafRg: qduZW: goto hmBBF; SWfSw: P_tMr: goto xzBRH; Zm0cg: if (!$this->getConfig()->get("\143\x61\143\150\x65\137\155\x6f\x62\x69\154\x65")) { goto zafYr; } goto SNz_L; LhrbM: return $this->memoize(__FUNCTION__, [], false); goto lafRg; SNz_L: return $this->memoize(__FUNCTION__, [], true); goto E1UdK; UEoZS: DlIz4: goto i5H20; kL19n: return $this->memoize(__FUNCTION__, [], false); goto SWfSw; IFQsS: if (!preg_match("\43\136\56\x2a\50" . $uas . "\51\56\x2a\x23\x69", $this->getConfig()->getServerInput("\x48\x54\x54\x50\137\125\x53\x45\x52\137\101\107\x45\x4e\124"))) { goto qduZW; } goto LhrbM; T48ui: return $this->getMemoizedBy(__FUNCTION__); goto UEoZS; xzBRH: return $this->memoize(__FUNCTION__, [], true); goto ZiAGC; i5H20: if ($this->getConfig()->getServerInput("\x48\124\x54\x50\137\125\123\x45\122\137\101\107\105\116\x54")) { goto tO0UL; } goto bwYEk; UvDvC: tO0UL: goto Zm0cg; E1UdK: zafYr: goto Sfh8I; hmBBF: $uas = "\167\63\x63\134\40\174\x77\63\143\55\174\x61\143\x73\55\x7c\x61\154\x61\x76\174\x61\x6c\x63\141\174\141\155\x6f\151\174\141\x75\x64\151\x7c\x61\x76\x61\x6e\174\142\145\x6e\x71\x7c\x62\x69\x72\144\x7c\142\154\141\x63\x7c\x62\154\x61\x7a\x7c\x62\x72\145\167\174\143\145\x6c\154\174\143\154\x64\143\174\143\x6d\144\55\x7c\x64\141\x6e\147\174\144\157\143\x6f\x7c\145\162\x69\x63\x7c\x68\x69\160\164\174\x68\x74\143\x5f\174\x69\156\156\157\174\x69\160\x61\x71\x7c\151\160\157\144\174\152\151\x67\163\x7c\153\x64\144\151\x7c\153\145\152\x69\174\x6c\145\156\x6f\174\x6c\x67\x2d\143\174\x6c\147\x2d\x64\x7c\x6c\x67\55\x67\x7c\x6c\x67\x65\x2d\x7c\x6c\x67\x2f\x75\x7c\x6d\141\165\x69\174\x6d\141\x78\157\174\x6d\151\x64\160\x7c\x6d\151\x74\163\x7c\155\155\145\x66\174\155\157\x62\x69\174\x6d\x6f\164\55\174\x6d\x6f\164\157\x7c\155\x77\x62\x70\x7c\156\145\143\x2d\174\x6e\145\x77\164\174\156\157\153\x69\x7c\160\141\154\155\x7c\160\x61\156\x61\174\x70\x61\x6e\164\174\x70\x68\x69\154\x7c\x70\x6c\x61\171\174\x70\157\x72\x74\x7c\x70\162\157\x78\174\x71\167\x61\160\174\x73\141\x67\x65\x7c\x73\x61\155\163\x7c\163\141\x6e\171\x7c\163\143\x68\x2d\x7c\x73\x65\143\55\x7c\163\x65\x6e\144\x7c\163\x65\x72\x69\x7c\x73\147\150\55\x7c\163\150\x61\x72\174\163\x69\x65\x2d\174\163\151\x65\x6d\174\x73\155\x61\x6c\174\x73\x6d\141\x72\x7c\163\157\x6e\x79\x7c\x73\x70\150\55\174\163\x79\x6d\142\x7c\164\55\155\157\x7c\164\145\154\x69\x7c\164\151\x6d\55\x7c\x74\x6f\163\150\174\164\x73\155\x2d\x7c\165\160\x67\61\174\x75\x70\163\151\x7c\x76\153\55\x76\x7c\166\x6f\x64\x61\174\x77\x61\160\x2d\x7c\x77\141\160\x61\x7c\167\141\160\x69\174\x77\141\x70\160\174\167\x61\160\162\174\x77\145\x62\x63\x7c\x77\151\156\x77\174\167\151\156\167\x7c\170\x64\141\x5c\40\x7c\x78\144\141\x2d"; goto bdr0v; bdr0v: if (!preg_match("\43\136\x28" . $uas . "\x29\56\52\43\x69", $this->getConfig()->getServerInput("\x48\x54\124\120\x5f\x55\123\x45\122\x5f\101\x47\105\116\124"))) { goto P_tMr; } goto kL19n; bwYEk: return $this->memoize(__FUNCTION__, [], true); goto UvDvC; Sfh8I: $uas = "\x32\56\x30\x5c\40\115\x4d\x50\174\x32\x34\x30\x78\63\x32\x30\x7c\x34\x30\60\x58\62\64\x30\174\x41\x76\141\x6e\x74\x47\x6f\x7c\102\x6c\x61\x63\x6b\102\x65\162\162\x79\x7c\102\x6c\141\x7a\145\162\174\103\145\154\154\x70\x68\157\156\145\x7c\104\x61\156\147\x65\x72\x7c\x44\x6f\x43\x6f\115\x6f\174\x45\154\141\x69\156\145\x2f\x33\56\60\x7c\105\165\x64\x6f\x72\141\x57\x65\142\x7c\107\157\157\x67\x6c\145\x62\157\164\x2d\115\x6f\x62\x69\154\145\x7c\x68\x69\160\164\x6f\x70\x7c\111\105\115\x6f\x62\151\x6c\145\174\x4b\131\x4f\x43\x45\122\x41\x2f\127\130\63\61\60\113\174\114\107\x2f\x55\x39\71\x30\174\x4d\x49\x44\x50\x2d\62\x2e\174\115\x4d\x45\x46\x32\x30\x7c\115\x4f\x54\55\x56\x7c\116\x65\164\x46\x72\x6f\156\164\174\x4e\145\167\164\x7c\x4e\x69\x6e\x74\x65\x6e\x64\x6f\134\40\x57\151\151\x7c\116\151\x74\162\x6f\x7c\116\157\x6b\151\141\x7c\117\160\x65\x72\141\134\40\x4d\x69\x6e\151\174\x50\x61\x6c\155\174\120\x6c\x61\x79\x53\164\141\164\151\157\x6e\x5c\x20\x50\157\162\164\141\142\154\x65\x7c\160\x6f\x72\x74\141\154\x6d\x6d\x6d\174\x50\x72\x6f\x78\x69\x6e\145\164\x7c\x50\x72\x6f\x78\x69\x4e\145\164\174\123\110\x41\x52\120\x2d\124\121\x2d\x47\x58\61\60\174\x53\110\x47\x2d\151\71\60\x30\x7c\x53\x6d\141\154\154\x7c\123\x6f\156\x79\105\162\x69\143\x73\x73\x6f\x6e\x7c\123\x79\x6d\142\x69\141\x6e\134\x20\117\123\x7c\123\x79\155\142\151\141\x6e\117\123\174\x54\x53\x32\x31\151\x2d\x31\60\x7c\125\x50\56\x42\x72\x6f\167\163\x65\x72\174\125\120\56\114\151\156\153\x7c\167\145\x62\x4f\x53\x7c\x57\x69\156\x64\157\167\163\x5c\40\x43\x45\x7c\x57\151\x6e\x57\x41\x50\x7c\131\x61\150\157\157\x53\145\145\153\x65\162\x2f\x4d\61\x41\61\x2d\122\62\x44\x32\174\x69\120\150\x6f\x6e\145\174\151\x50\x6f\144\174\101\156\x64\162\157\151\x64\x7c\x42\154\x61\143\x6b\102\145\x72\x72\x79\71\x35\x33\60\174\x4c\107\x2d\124\125\x39\61\65\134\40\x4f\142\151\x67\157\174\114\107\105\134\x20\x56\130\174\167\x65\142\117\123\x7c\x4e\157\153\151\141\65\70\60\x30"; goto IFQsS; ZiAGC: } public function hasDontCachePage() { goto rpaVe; IHs9w: return false; goto yYyAC; bz9CA: return !apply_filters("\143\x61\x63\x68\x65\137\x6f\166\145\x72\x72\x69\144\x65\137\x64\157\x6e\x74\x5f\143\141\x63\150\145\x5f\x70\x61\147\145", false); goto sca70; yYyAC: rOhMU: goto bz9CA; rpaVe: if (!(!defined("\104\x4f\116\124\x5f\103\x41\x43\x48\105\137\120\x41\x47\105") || !DONT_CACHE_PAGE)) { goto rOhMU; } goto IHs9w; sca70: } public function is404() { return !function_exists("\151\x73\x5f\64\60\64") || is_404(); } public function isSearch() { goto bh3xc; iIq7v: return !apply_filters("\x63\141\x63\150\x65\x5f\143\141\x63\150\x65\137\x73\x65\141\x72\143\150", false); goto MtA_M; atteW: return false; goto YpbBB; bh3xc: if (!(function_exists("\151\x73\x5f\x73\145\x61\162\143\150") && !is_search())) { goto iDRcW; } goto atteW; YpbBB: iDRcW: goto iIq7v; MtA_M: } public function getIp() { goto Woaqg; bE4pj: return $this->memoize(__FUNCTION__, [], "\60\56\x30\x2e\60\56\60"); goto jGrbK; Fl5u8: $keys = ["\x48\x54\x54\120\137\103\x46\x5f\x43\x4f\x4e\x4e\105\103\x54\x49\x4e\107\x5f\111\120", "\110\x54\124\120\x5f\103\x4c\111\x45\x4e\124\x5f\111\x50", "\x48\124\124\120\137\x58\137\x46\117\122\x57\101\x52\104\105\x44\x5f\x46\117\x52", "\110\124\124\120\x5f\130\x5f\106\117\122\x57\101\122\104\105\x44", "\x48\x54\x54\x50\x5f\130\x5f\x43\x4c\x55\x53\124\x45\122\x5f\103\x4c\x49\105\116\x54\x5f\111\120", "\x48\x54\x54\120\x5f\130\x5f\x52\x45\101\x4c\137\x49\x50", "\x48\x54\124\120\137\106\117\x52\x57\x41\122\104\x45\x44\x5f\x46\x4f\x52", "\110\x54\124\120\x5f\x46\117\122\127\101\x52\x44\x45\x44", "\122\105\115\x4f\124\105\137\x41\x44\x44\122"]; goto Aohoj; Aohoj: foreach ($keys as $key) { goto V_2Ah; y1bfQ: $ip = explode("\54", $this->getConfig()->getServerInput($key)); goto esew1; gzlcv: if (!(false !== filter_var($ip, FILTER_VALIDATE_IP))) { goto t6vHj; } goto POtal; Q6kP_: dgQKt: goto y1bfQ; esew1: $ip = end($ip); goto gzlcv; CrotQ: ZXcIK: goto yf928; bdZ0J: goto ZXcIK; goto Q6kP_; POtal: return $this->memoize(__FUNCTION__, [], $ip); goto l6PLT; l6PLT: t6vHj: goto CrotQ; V_2Ah: if ($this->getConfig()->getServerInput($key)) { goto dgQKt; } goto bdZ0J; yf928: } goto ibtr7; ibtr7: k7rs4: goto bE4pj; vth1o: return $this->getMemoizedBy(__FUNCTION__); goto FoYm5; Woaqg: if (!$this->isMemoized(__FUNCTION__)) { goto ESPnd; } goto vth1o; FoYm5: ESPnd: goto Fl5u8; jGrbK: } public function isSpeedTool() { goto voLHp; voLHp: if (!$this->isMemoized(__FUNCTION__)) { goto XxuDQ; } goto n7nvq; Tv0X2: $user_agent = preg_match("\43\x50\151\156\x67\144\x6f\x6d\x50\141\x67\x65\x53\160\x65\145\x64\x7c\x44\141\162\145\102\x6f\157\163\164\x7c\x47\x6f\157\147\x6c\x65\x7c\x50\124\123\124\174\x43\x68\162\x6f\x6d\145\55\x4c\151\147\x68\164\150\x6f\165\163\145\174\x57\x50\40\103\x61\143\150\145\43\x69", $this->getConfig()->getServerInput("\110\x54\x54\120\x5f\125\123\x45\x52\x5f\101\x47\x45\x4e\124")); goto NxNEE; n7nvq: return $this->getMemoizedBy(__FUNCTION__); goto bkPLG; jFW0K: if (!isset($ips[$this->getIp()])) { goto MdYh1; } goto PEgQF; bkPLG: XxuDQ: goto KcO67; KcO67: $ips = ["\62\x30\70\x2e\67\x30\x2e\62\x34\x37\x2e\61\x35\x37" => '', "\x32\60\64\56\61\70\67\x2e\x31\64\56\x37\60" => '', "\62\x30\x34\x2e\x31\x38\x37\56\61\x34\x2e\67\61" => '', "\x32\60\64\x2e\x31\70\x37\56\x31\x34\x2e\x37\x32" => '', "\62\60\x34\x2e\x31\x38\67\56\61\x34\56\67\x33" => '', "\62\x30\64\56\61\70\x37\56\x31\64\56\67\x34" => '', "\62\x30\x34\56\61\70\67\x2e\x31\64\x2e\67\65" => '', "\62\x30\64\x2e\x31\x38\67\x2e\61\x34\56\x37\66" => '', "\x32\x30\64\56\61\70\67\x2e\x31\x34\x2e\x37\67" => '', "\x32\x30\x34\56\x31\70\67\x2e\61\64\x2e\x37\70" => '', "\61\71\x39\x2e\x31\x30\x2e\63\61\x2e\61\71\64" => '', "\x31\63\x2e\70\65\x2e\x38\60\x2e\61\62\64" => '', "\x31\x33\56\70\64\56\x31\64\x36\x2e\x31\63\62" => '', "\61\x33\56\x38\x34\x2e\61\x34\x36\56\x32\62\x36" => '', "\64\60\x2e\x37\x34\x2e\x32\65\64\56\x32\61\x37" => '', "\x31\63\56\70\64\56\64\63\x2e\x32\x32\67" => '', "\x31\x37\x32\x2e\x32\65\65\x2e\66\61\56\63\x34" => '', "\x31\x37\x32\56\x32\65\x35\56\x36\x31\x2e\x33\65" => '', "\61\x37\x32\x2e\x32\65\65\56\x36\61\56\63\x36" => '', "\61\67\x32\x2e\x32\x35\x35\56\x36\x31\x2e\63\x37" => '', "\61\67\x32\56\x32\65\x35\56\66\61\x2e\63\x38" => '', "\x31\x37\62\56\62\x35\x35\56\x36\61\56\x33\x39" => '', "\x31\67\x32\56\x32\x35\65\56\x36\61\x2e\64\60" => '', "\61\x33\x2e\67\x30\56\x36\x36\56\x32\60" => '', "\61\71\61\56\x32\63\x35\56\70\65\x2e\x31\x35\x34" => '', "\61\71\61\56\x32\x33\x35\56\70\x36\x2e\x30" => '', "\65\x32\x2e\66\66\56\67\x35\x2e\61\64\67" => '', "\x35\62\56\61\x37\x35\x2e\62\x38\x2e\61\61\66" => '']; goto jFW0K; tuqDy: um_0f: goto Tv0X2; yonkq: MdYh1: goto GwLlO; GwLlO: if ($this->getConfig()->getServerInput("\x48\x54\124\x50\x5f\x55\123\105\x52\x5f\101\x47\105\x4e\x54")) { goto um_0f; } goto Pvdlf; PEgQF: return $this->memoize(__FUNCTION__, [], true); goto yonkq; NxNEE: return $this->memoize(__FUNCTION__, [], (bool) $user_agent); goto szpNV; Pvdlf: return $this->memoize(__FUNCTION__, [], false); goto tuqDy; szpNV: } public function isSSL() { goto UoDk9; V36qo: return true; goto wV8ff; Gq6S0: return true; goto f86nv; fHfmN: return true; goto xxdtq; fLI4o: goto F45ag; goto ZKQmi; ZKQmi: cTj4p: goto NPEM4; JUM0G: if (null !== $config->getServerInput("\110\124\x54\120\123")) { goto cTj4p; } goto p0z08; wV8ff: F45ag: goto G0yrJ; p0z08: if ("\64\x34\x33" === (string) $config->getServerInput("\x53\105\x52\126\105\122\137\120\x4f\x52\x54")) { goto rRxfK; } goto fLI4o; k6Qii: rRxfK: goto V36qo; G0yrJ: return false; goto QQLV6; UoDk9: $config = $this->getConfig(); goto JUM0G; SWH4P: goto F45ag; goto k6Qii; xxdtq: t6rpl: goto SWH4P; Q8Wmr: if (!("\x31" === (string) $config->getServerInput("\110\x54\124\120\x53"))) { goto t6rpl; } goto fHfmN; f86nv: HUGVp: goto Q8Wmr; NPEM4: if (!("\157\x6e" === strtolower($config->getServerInput("\x48\124\124\x50\123")))) { goto HUGVp; } goto Gq6S0; QQLV6: } public function isOptReq() : bool { $post = $this->getPost(); return isset($post["\x6f\x70\164\151\x6d\x69\172\141\164\x69\x6f\156\x5f\160\x72\157\x63\145\x73\x73"]) && $post["\x6f\160\x74\x69\x6d\x69\x7a\x61\164\x69\157\156\137\160\162\x6f\x63\145\163\163"]; } public function getRawRequestUri() { goto TBoYP; wjXhp: return "\x2f" . ltrim($this->getConfig()->getServerInput("\122\105\121\x55\105\123\124\x5f\x55\x52\111"), "\57"); goto VrHSV; HthwD: return ''; goto wejCf; TBoYP: if (!('' === $this->getConfig()->getServerInput("\122\105\121\x55\105\x53\x54\137\x55\122\111", ''))) { goto R5HBG; } goto HthwD; wejCf: R5HBG: goto wjXhp; VrHSV: } public function getRequestUriBase() { goto Ag_A4; cX1PR: G1E77: goto H0lS4; Ag_A4: $requestUri = $this->getRawRequestUri(); goto fPJaJ; RN28S: return reset($requestUri); goto NknTz; fPJaJ: if ($requestUri) { goto G1E77; } goto y_a2f; y_a2f: return ''; goto cX1PR; H0lS4: $requestUri = explode("\x3f", $requestUri); goto RN28S; NknTz: } public function getCleanRequestUri() { goto PrOTA; J2CHa: KnKrY: goto OWBRk; rqWdH: if ($queryString) { goto R_yvR; } goto ezpga; mqXcW: R_yvR: goto lY7Pp; eCKRM: return ''; goto J2CHa; OWBRk: $queryString = $this->getQueryString(); goto rqWdH; Ip0fc: if ($requestUri) { goto KnKrY; } goto eCKRM; PrOTA: $requestUri = $this->getRequestUriBase(); goto Ip0fc; ezpga: return $requestUri; goto mqXcW; lY7Pp: return $requestUri . "\77" . $queryString; goto t9O0R; t9O0R: } public function getRequestMethod() { goto gcQY2; b_mOx: bzU7G: goto HXo1L; HXo1L: return strtoupper($this->getConfig()->getServerInput("\122\105\121\125\x45\x53\124\137\x4d\x45\x54\110\x4f\104")); goto j8_0p; gcQY2: if (!('' === $this->getConfig()->getServerInput("\122\x45\x51\125\105\123\x54\x5f\115\105\x54\x48\117\x44", ''))) { goto bzU7G; } goto mpRra; mpRra: return ''; goto b_mOx; j8_0p: } public function getQueryParams() { goto H1j7C; Es3zd: ksort($params); goto sZkbx; sZkbx: It1Ru: goto Hb6NV; Hb6NV: owQJ_: goto TfPfR; oB9bG: $params = array_diff_key($get, $ignores); goto NDrvW; RgUlS: $ignores = (array) $this->getConfig()->get("\x63\x61\x63\150\145\137\x69\x67\156\x6f\x72\145\x64\x5f\x70\141\162\141\x6d\145\164\145\x72\163"); goto oB9bG; TfPfR: return $params; goto xEAih; H1j7C: $get = $this->getGet(); goto bK9Ma; NDrvW: if (!$params) { goto It1Ru; } goto Es3zd; bK9Ma: $params = []; goto DInBE; DInBE: if (!$get) { goto owQJ_; } goto RgUlS; xEAih: } public function getQueryString() { return http_build_query($this->getQueryParams()); } public function getCookies() { return $this->cookies; } public function getPost() { return $this->post; } public function getGet() { return $this->get; } protected function setError(?string $message, $data = []) { $this->lastError = ["\x6d\x65\163\x73\141\147\x65" => $message, "\x64\x61\164\141" => (array) $data]; } public function getLastError($class = null, $method = null) { return array_merge(["\155\x65\x73\x73\141\x67\145" => "\105\162\x72\157\162\40\155\145\163\163\x61\147\145\40\x69\x73\x20\145\155\x70\x74\x79", "\144\x61\x74\141" => ["{$class}\72\72{$method}"]], (array) $this->lastError); } }
