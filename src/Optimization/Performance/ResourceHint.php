<?php
 namespace Optimization\Performance; use Boilerplate\DOMCrawler; use Boilerplate\Util\StringUtil; use Boilerplate\Util\ThemeUtil; use Optimization\Util\Util; use DOMElement; class ResourceHint extends Common { const IMAGE_PRELOAD_ATTRS = array("\x69\x6d\x61\x67\145\x73\162\x63\163\145\x74" => "\x73\162\x63\x73\x65\x74", "\151\x6d\x61\147\145\x73\151\x7a\x65\x73" => "\x73\151\172\145\x73", "\150\162\145\146" => "\x73\x72\143"); public function addActions() : self { $this->addAction("\167\x70\137\x68\145\141\144", [$this, "\160\x72\x65\x6c\157\141\x64\106\x6f\156\x74\163"], 0, 50); return parent::addActions(); } public function addFilters() : self { $this->addFilter("\167\x70\x5f\162\x65\x73\157\x75\162\x63\145\x5f\x68\151\156\x74\163", [$this, "\162\x65\x73\x6f\165\x72\143\145\x48\151\x6e\x74"], 2)->addFilter("\x6f\x70\x74\151\155\151\x7a\141\x74\151\157\156\x5f\142\165\146\x66\145\x72\x5f\x70\162\157\143\145\x73\x73", [$this, "\x70\x72\x65\154\157\x61\x64\111\155\x61\147\145\163"]); return parent::addFilters(); } public function preloadImages($buffer) { goto z3Z8B; C6IpC: $links = implode('', $links); goto tyHGi; jOp11: oA23h: goto RjwQC; Op3SR: $selector = $this->applyFilters("\x6f\160\164\x69\155\x69\x7a\141\x74\x69\x6f\156\137\160\145\162\146\x6f\162\x6d\141\156\143\145\137\162\x65\163\157\165\x72\x63\145\x5f\150\151\156\164\x5f\151\x6d\x61\x67\x65\x5f\x70\162\145\154\x6f\x61\144\137\x73\145\154\x65\143\x74\157\162", "\x69\x6d\x67"); goto LD7u0; J03VV: return $buffer; goto PFbLV; LD7u0: if (!DOMCrawler::has($buffer, $selector)) { goto oA23h; } goto WK_h4; G68zE: Tu0R3: goto J03VV; z3Z8B: $links = []; goto Op3SR; WK_h4: $buffer = DOMCrawler::elementsMap($buffer, $selector, function (DOMElement $node) use(&$links) { goto L_xYT; VNQn3: if (!$attrs) { goto FwqdJ; } goto yDEEK; Vm7ti: $attrs["\162\145\154"] = "\160\x72\x65\x6c\x6f\141\144"; goto LZr4G; yDEEK: $attrs["\x61\163"] = "\x69\x6d\x61\x67\145"; goto Vm7ti; lSTAq: foreach (self::IMAGE_PRELOAD_ATTRS as $link => $img) { goto BQTVR; ATNxq: $attrs[$link] = $value; goto Bpvkk; oF3zL: if (!$value) { goto DGpC3; } goto ATNxq; BQTVR: $value = $node->getAttribute($img); goto oF3zL; CjC9B: t7_jO: goto gDFJ4; Bpvkk: DGpC3: goto CjC9B; gDFJ4: } goto kDCyK; L_xYT: $attrs = []; goto lSTAq; JuIkf: FwqdJ: goto lkZ6J; kDCyK: hBvRl: goto VNQn3; lkZ6J: return true; goto RXdND; LZr4G: $links[] = ThemeUtil::generateElement("\154\151\x6e\x6b", $attrs); goto JuIkf; RXdND: }, 6, false); goto jOp11; RjwQC: if (!$links) { goto Tu0R3; } goto C6IpC; tyHGi: $buffer = StringUtil::replaceFirst("\x3c\x2f\150\145\141\x64\76", "{$links}\x3c\x2f\150\145\141\x64\76", $buffer); goto G68zE; PFbLV: } public function preloadFonts() { goto Joi16; achRw: oLz8M: goto HHYEN; Joi16: $fonts = (array) apply_filters("\157\x70\x74\x69\155\151\x7a\141\x74\x69\x6f\156\137\160\145\162\x66\x6f\x72\155\x61\x6e\x63\x65\x5f\162\x65\163\157\165\x72\143\x65\137\x68\x69\163\x74\x5f\146\x6f\x6e\164\163", []); goto uvFqQ; uvFqQ: foreach ($fonts as $font) { echo ThemeUtil::generateElement("\x6c\151\x6e\x6b", ["\162\x65\154" => "\160\162\x65\154\157\x61\x64", "\x68\x72\x65\146" => $font["\165\162\154"], "\x61\x73" => "\x66\x6f\156\x74", "\x74\171\x70\x65" => "\146\157\156\164\57{$font["\146\x6f\x72\x6d\x61\x74"]}", "\143\162\x6f\163\163\x6f\x72\x69\x67\151\x6e"]); pjEqh: } goto achRw; HHYEN: } public function resourceHint($hints, $relationType) { goto qrGt1; AVElp: return $hints; goto aPtFY; IrZaN: rIG4C: goto ydiiU; ydiiU: XhpNF: goto AVElp; M2W8c: YGtBj: goto IrZaN; DlxY2: switch ($relationType) { case "\160\162\145\x63\x6f\156\156\145\x63\164": case "\144\x6e\x73\55\160\x72\x65\146\x65\164\x63\150": goto OrE19; XuJhM: crDh3: goto X46Bh; OIruC: $hints = $this->removeEmojiDnsPrefetch($hints); goto Nkax7; Nkax7: JVGsy: goto lYhhE; OrE19: if (!($relationType == "\144\156\x73\55\x70\x72\145\x66\x65\x74\x63\150")) { goto JVGsy; } goto OIruC; gQpQC: foreach ($domains as $domain) { goto u2Uwr; LPsJP: $hints[] = ["\x68\x72\x65\x66" => $domain, "\x63\x72\157\x73\x73\157\162\x69\x67\x69\x6e"]; goto kEMMz; kEMMz: FK_xU: goto pU0Qe; pU0Qe: jyujq: goto nbFO9; u2Uwr: if (!$domain) { goto FK_xU; } goto LPsJP; nbFO9: } goto XuJhM; X46Bh: goto rIG4C; goto YlwyB; lYhhE: $domains = (array) $this->applyFilters("\x6f\x70\x74\151\x6d\x69\172\x61\164\x69\x6f\156\x5f\160\x65\x72\x66\x6f\162\155\141\156\x63\x65\x5f\x72\x65\163\x6f\x75\x72\143\x65\137\x68\151\156\x74", []); goto gQpQC; YlwyB: } goto M2W8c; qrGt1: if (Util::getConstant("\x44\x4f\x4e\124\137\120\105\x52\x46\117\122\115\x41\116\103\x45\137\117\120\x54\x49\x4d\111\x5a\105")) { goto XhpNF; } goto DlxY2; aPtFY: } public static function removeEmojiDnsPrefetch($hints) { $hints = array_diff(wp_dependencies_unique_hosts(), $hints); return $hints; } }
