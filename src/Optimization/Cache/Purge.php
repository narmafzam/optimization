<?php
 namespace Optimization\Cache; use Boilerplate\Util\PostUtil; use Boilerplate\Util\UserUtil; use Optimization\Purge as BaseClass; use Optimization\Util\FileUtil; use Optimization\Util\FormatUtil; use Optimization\Util\I18NUtil; class Purge extends BaseClass { public function __construct() { goto t_Ysr; ROE4x: $this->paths = [Util::getCachePath()]; goto PoBba; PoBba: parent::__construct(); goto Ul4Dp; t_Ysr: $this->id = "\143\141\x63\x68\145"; goto ROE4x; Ul4Dp: } public function addActions() : self { $this->addAction("\144\x65\x6c\x65\164\145\137\x70\x6f\163\x74", [$this, "\143\x6c\x65\x61\x6e\120\157\163\x74"])->addAction("\167\160\x5f\165\x70\x64\141\x74\x65\137\x6e\141\166\x5f\155\x65\x6e\x75", [$this, "\143\x6c\x65\141\x6e\104\157\x6d\141\x69\x6e"])->addAction("\165\x70\144\141\164\x65\x5f\157\160\x74\x69\x6f\156\137\163\x69\x64\x65\x62\141\x72\163\137\x77\x69\x64\x67\145\164\163", [$this, "\x63\154\x65\x61\x6e\104\x6f\155\x61\151\156"])->addAction("\x70\145\162\x6d\141\x6c\151\156\x6b\137\x73\164\162\x75\143\164\x75\x72\x65\137\143\x68\x61\156\x67\145\x64", [$this, "\x63\x6c\x65\141\x6e\104\157\x6d\141\151\x6e"])->addAction("\x65\144\151\164\137\164\145\x72\x6d", [$this, "\155\141\171\142\x65\120\x75\162\147\145\103\141\x63\150\x65\117\x6e\124\x65\x72\x6d\x43\x68\x61\x6e\x67\145"], 3)->addAction("\x63\162\x65\x61\164\x65\x5f\x74\145\x72\155", [$this, "\x6d\141\x79\142\x65\120\x75\x72\147\x65\x43\x61\143\x68\x65\x4f\156\124\145\162\x6d\103\x68\141\x6e\147\145"], 3)->addAction("\144\145\x6c\x65\164\x65\137\x74\x65\162\155", [$this, "\155\141\171\142\145\x50\x75\x72\x67\x65\x43\x61\143\x68\145\117\156\124\x65\162\155\103\x68\141\x6e\147\x65"], 3)->addAction("\x70\x72\145\x5f\160\x6f\163\164\137\165\x70\x64\x61\164\145", [$this, "\x70\165\x72\x67\145\x50\x6f\163\x74\x4f\156\123\x6c\165\x67\103\x68\141\x6e\x67\x65"], 2, 99999)->addAction("\x77\x70\x5f\x75\x70\x64\141\x74\145\137\x63\157\155\x6d\145\156\x74\x5f\x63\157\x75\x6e\x74", [$this, "\x63\154\x65\141\156\x50\157\163\164"])->addAction("\165\160\144\141\164\x65\x5f\157\x70\164\x69\157\x6e\x5f\164\141\147\137\142\x61\x73\x65", [$this, "\143\x6c\x65\x61\x6e\x44\x6f\x6d\141\151\156"])->addAction("\x75\160\144\141\164\x65\137\157\x70\164\151\x6f\x6e\x5f\x63\x61\x74\x65\x67\157\162\171\137\142\141\x73\145", [$this, "\143\154\x65\141\156\104\157\155\x61\x69\156"])->addAction("\141\x64\x64\x5f\x6c\x69\156\x6b", [$this, "\x63\154\x65\141\156\104\157\x6d\141\151\156"])->addAction("\145\x64\151\x74\x5f\154\x69\156\x6b", [$this, "\143\x6c\x65\141\156\104\x6f\155\x61\151\x6e"])->addAction("\x64\x65\x6c\145\x74\x65\137\x6c\151\x6e\153", [$this, "\x63\x6c\x65\141\156\104\x6f\155\x61\151\156"])->addAction("\143\165\x73\164\x6f\x6d\151\x7a\x65\x5f\163\x61\166\x65", [$this, "\143\x6c\145\x61\x6e\104\157\155\141\151\156"])->addAction("\165\160\x64\141\164\145\x5f\x6f\160\x74\x69\x6f\x6e\137\x74\x68\x65\x6d\145\137\155\x6f\x64\163\x5f" . Util::getOption("\x73\x74\x79\154\x65\x73\150\x65\145\164"), [$this, "\143\154\145\x61\156\104\157\155\141\151\156"])->addAction("\x77\x70\137\164\x72\141\163\150\137\160\x6f\163\164", [$this, "\143\x6c\x65\x61\156\x50\x6f\163\x74"])->addAction("\143\154\145\141\156\x5f\160\157\163\164\137\x63\141\143\150\x65", [$this, "\143\x6c\x65\141\x6e\x50\x6f\x73\x74"])->addAction("\x70\162\x65\137\160\157\163\x74\137\x75\x70\x64\141\x74\145", [$this, "\143\x6c\145\141\156\120\157\163\x74\x43\141\x63\150\145\x4f\156\x53\164\141\x74\x75\x73\x43\150\141\x6e\147\145"], 2)->addAction("\x61\x64\155\x69\x6e\x5f\x70\x6f\x73\x74\137\x6f\x70\164\x69\x6d\151\172\x61\164\151\157\x6e\x5f\160\165\x72\147\x65\x5f\157\160\143\x61\143\x68\x65", [$this, "\x61\144\x6d\151\156\x50\x6f\163\x74\120\165\162\x67\145\x4f\160\x63\x61\143\150\x65"])->addAction("\144\145\x6c\x65\x74\145\137\x75\163\x65\162", [$this, "\160\165\162\x67\145\x55\x73\x65\x72\x43\141\143\x68\145"])->addAction("\160\x72\157\x66\151\154\145\137\x75\160\144\x61\x74\x65", [$this, "\160\165\162\147\145\125\163\x65\x72\103\141\143\x68\145"]); return parent::addActions(); } public function purgePostOnSlugChange($u2ese, $vwB7A) { goto LW3JM; GyOBm: iXZdM: goto aoUJb; aoUJb: U4O_w: goto ewgOS; LW3JM: $g0ltr = PostUtil::getStatus($u2ese); goto ldRem; WjE5U: if (!($wYOl6 && $wYOl6 !== $vwB7A["\x70\x6f\163\x74\137\x6e\x61\x6d\x65"])) { goto iXZdM; } goto x0C0F; ldRem: if (in_array($g0ltr, ["\x64\162\x61\146\164", "\x70\145\156\x64\x69\x6e\x67", "\x61\165\164\157\55\144\x72\x61\146\x74"], true)) { goto U4O_w; } goto qsll2; x0C0F: $this->cleanFiles(PostUtil::getPermalink($u2ese)); goto GyOBm; qsll2: $wYOl6 = PostUtil::getSlug($u2ese); goto WjE5U; ewgOS: } public function addFilters() : self { $this->addFilter("\x77\151\x64\x67\x65\x74\x5f\x75\160\144\x61\164\x65\x5f\x63\x61\x6c\154\x62\141\143\x6b", [$this, "\x77\x69\144\x67\x65\x74\125\x70\x64\141\x74\x65\x43\x61\x6c\154\x62\x61\143\x6b"]); return parent::addFilters(); } public function resetOpcache() { goto BcVbO; ObftM: return false; goto ur1iA; BcVbO: static $cQlm7; goto zAtMx; zAtMx: do_action("\157\x70\x74\x69\155\151\172\x61\164\151\157\x6e\137\142\145\146\x6f\x72\x65\137\x72\145\x73\145\164\137\x6f\x70\143\141\x63\150\x65"); goto LWjko; QIcFa: if (!function_exists("\157\160\x63\x61\143\150\145\x5f\x72\145\x73\x65\x74")) { $cQlm7 = false; return false; } goto XNcMm; JBjci: SZu_c: goto sCdAy; LWjko: if (isset($cQlm7)) { goto SZu_c; } goto QIcFa; C6LG1: W5LCz: goto aVMwu; XNcMm: $TjjJ1 = ini_get("\x6f\x70\x63\141\x63\x68\145\x2e\162\145\163\x74\162\151\143\164\x5f\141\x70\151"); goto By42z; sCdAy: if ($cQlm7) { goto qwROg; } goto ObftM; zZ00S: $cQlm7 = false; goto TTj2Y; ur1iA: qwROg: goto KboS2; KboS2: $nM61U = opcache_reset(); goto YjbYg; By42z: if (!($TjjJ1 && strpos(__FILE__, $TjjJ1) !== 0)) { goto W5LCz; } goto zZ00S; TTj2Y: return false; goto C6LG1; erxVQ: return $nM61U; goto vY0in; aVMwu: $cQlm7 = true; goto JBjci; YjbYg: do_action("\x6f\160\x74\x69\155\x69\172\x61\164\x69\157\x6e\137\141\146\164\145\x72\x5f\x72\145\x73\145\164\137\x6f\x70\143\x61\143\150\x65"); goto erxVQ; vY0in: } public function purgeUserCache($p1ua7) { goto l_0JB; h1Cbg: Bu9w5: goto kSjZt; rca0z: $this->cleanUser($p1ua7); goto h1Cbg; l_0JB: if (!$this->shouldPurgeUserCache()) { goto Bu9w5; } goto rca0z; kSjZt: } private function shouldPurgeUserCache() { goto YlFkc; YlFkc: $OaTi2 = false; goto j7p1F; ivmXb: return $OaTi2; goto yQx7K; j7p1F: $OaTi2 = !(bool) $this->applyFilters("\157\160\164\x69\x6d\x69\x7a\x61\164\x69\x6f\156\x5f\x63\x6f\x6d\155\157\156\x5f\x63\141\x63\x68\145\x5f\x6c\157\x67\x67\x65\x64\x5f\x75\x73\145\162\x73", false); goto ivmXb; yQx7K: } public function cleanUser($Q6Bxn, $Onk5O = '') { goto RgO9b; hO06l: foreach ($BWnT3 as $hgTz4) { goto m4PWR; geozE: $NFJp4["\150\x6f\163\x74"] = FormatUtil::maybeUrlNoDots($NFJp4["\150\x6f\163\x74"]); goto NpR_t; TJ9go: pz_ht: goto JsSL0; p5R7p: $tQVlb = Util::getConstant("\117\120\124\x49\x4d\111\x5a\x41\124\x49\x4f\x4e\137\103\101\x43\110\x45\x5f\120\x41\x54\110") . $NFJp4["\150\x6f\x73\164"] . "\x2d" . $l6zhM . "\x2a" . $NFJp4["\x70\141\x74\x68"]; goto v089b; BZrB2: F20ul: goto DgcJG; q1RDs: if (!isset($NFJp4["\150\157\163\x74"])) { goto sQd5u; } goto geozE; NpR_t: sQd5u: goto p5R7p; WHIa0: if (!$fTqn_) { goto F20ul; } goto gh9vt; ibFKL: $fTqn_ = glob($tQVlb . "\x2a", GLOB_NOSORT); goto WHIa0; W89DK: RNMvE: goto BZrB2; v089b: $this->doAction("\157\x70\x74\x69\155\x69\172\141\x74\151\x6f\x6e\137\x62\145\x66\157\162\145\x5f\x63\x61\x63\150\145\137\x63\x6c\x65\141\x6e\x5f\x75\x73\145\x72", $Q6Bxn, $Onk5O); goto ibFKL; m4PWR: $NFJp4 = FormatUtil::getParseUrl($hgTz4); goto q1RDs; DgcJG: $this->doAction("\157\x70\164\x69\x6d\x69\x7a\141\x74\151\x6f\x6e\x5f\141\x66\164\145\162\137\143\x61\x63\x68\145\137\x63\x6c\145\x61\x6e\137\165\x73\x65\162", $Q6Bxn, $Onk5O); goto TJ9go; gh9vt: foreach ($fTqn_ as $lzD2z) { FileUtil::rrmdir($lzD2z, I18NUtil::getDirectoriesToPreserve($Onk5O)); ptWvI: } goto W89DK; JsSL0: } goto dn80R; QYEAb: $l6zhM = $p1ua7->user_login . "\55"; goto hO06l; td0iN: $BWnT3 = array_filter($BWnT3); goto HOKve; oHCv2: if (!$p1ua7) { goto NIz6M; } goto QYEAb; HOKve: $p1ua7 = UserUtil::getField($Q6Bxn); goto oHCv2; RgO9b: $BWnT3 = !$Onk5O || is_object($Onk5O) ? I18NUtil::getUri() : I18NUtil::getHomeUrlByLang($Onk5O); goto D7XeW; dn80R: QPApx: goto kd5gF; B0J56: $BWnT3 = $this->applyFilters("\157\160\x74\151\155\x69\172\141\164\x69\x6f\156\137\143\x6c\145\141\156\137\144\x6f\155\x61\x69\156\x5f\x75\x72\x6c\163", $BWnT3, $Onk5O); goto td0iN; kd5gF: NIz6M: goto cAp27; D7XeW: $BWnT3 = (array) $BWnT3; goto B0J56; cAp27: } public function adminPostPurgeOpcache() { goto RRNux; gTxUt: set_transient(UserUtil::getId() . "\137\157\x70\143\x61\143\x68\145\x5f\160\x75\162\x67\145\137\x72\145\x73\165\154\164", $CRRxp); goto j4tGV; W5u8f: if (!UserUtil::currentCan("\x6d\x61\x6e\x61\147\x65\137\x6f\160\x74\x69\157\156\163")) { goto hU19X; } goto O5wdD; pejo2: $CRRxp = ["\x72\x65\x73\x75\154\164" => "\163\x75\143\x63\145\x73\163", "\x6d\145\163\163\x61\147\145" => __("\x4f\120\x63\141\x63\x68\145\40\163\165\143\x63\145\163\x73\x66\x75\x6c\x6c\171\40\160\x75\162\x67\x65\144", OPTIMIZATION_DOMAIN)]; goto LR3gM; jQ6Ry: hU19X: goto FweOb; LR3gM: goto EeymZ; goto AuvEk; RRNux: if (!(!isset($_GET["\137\167\x70\156\157\x6e\x63\145"]) || !wp_verify_nonce(sanitize_key($_GET["\x5f\167\x70\156\157\156\143\x65"]), "\157\160\164\151\155\x69\x7a\x61\x74\x69\x6f\x6e\x5f\x70\165\x72\147\x65\x5f\157\x70\143\141\143\x68\x65"))) { goto WsFX5; } goto VTLAm; OfuMi: die; goto jQ6Ry; k7Ms_: WsFX5: goto W5u8f; AuvEk: Fj4rd: goto yxUus; yxUus: $CRRxp = ["\162\145\x73\165\154\164" => "\x65\x72\162\157\162", "\x6d\145\163\x73\141\x67\x65" => __("\117\x50\x63\x61\143\x68\145\40\160\x75\162\x67\145\40\146\x61\151\154\x65\144\x2e", OPTIMIZATION_DOMAIN)]; goto J4YYo; VTLAm: wp_nonce_ays(''); goto k7Ms_; O5wdD: $nM61U = $this->resetOpcache(); goto a_iOl; J4YYo: EeymZ: goto gTxUt; j4tGV: wp_safe_redirect(esc_url_raw(wp_get_referer())); goto OfuMi; a_iOl: if (!$nM61U) { goto Fj4rd; } goto pejo2; FweOb: } public function widgetUpdateCallback($E9o22) { $this->cleanDomain(); return $E9o22; } }
