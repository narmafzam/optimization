<?php
 namespace Optimization\Cache; use Boilerplate\Detector\Detector; use Boilerplate\Filesystem; use Boilerplate\Util\ArrayUtil; use Boilerplate\Util\CommonUtil; use Optimization\Buffer\Config; use Optimization\Buffer\Test; use Optimization\Buffer\Buffer as BaseClass; class Buffer extends BaseClass { protected ?string $id = "\143\141\x63\x68\x69\156\147\137\x70\x72\157\143\x65\x73\x73"; protected Config $config; protected ?string $path; protected Filesystem $filesystem; public function __construct(?Test $test, Config $config, array $args = []) { goto MkeHQ; vAQbN: $this->config = $config; goto nAn4s; ffZIH: $this->log("\x43\101\x43\110\x49\116\107\x20\x50\x52\117\103\105\123\x53\40\123\x54\x41\122\124\x45\x44\x2e", [], "\x69\156\x66\157"); goto bNxIk; spwsS: parent::__construct($test); goto ffZIH; nAn4s: $this->filesystem = Filesystem::getInstance(); goto spwsS; MkeHQ: $this->path = trailingslashit($args["\160\141\x74\x68"]); goto vAQbN; bNxIk: } public function getConfig() : Config { return $this->config; } public function getPath() : ?string { return $this->path; } public function getFilesystem() : Filesystem { return $this->filesystem; } public function maybeInitProcess() { goto S1bAK; ruaiZ: $this->dontPerformanceOptimize(); goto CI304; pTAhq: $this->serveGzipCacheFile($cacheFilepathGzip); goto Q0ami; MpJhs: goto RJrgV; goto VNivC; dwnj4: $this->serveCacheFile($cacheFilepath); goto SaGrr; qwVfg: $cacheFilepath = $this->getCachePath(); goto Ml7IJ; VNivC: V_Bgp: goto qwVfg; RMc1L: if (!$this->getFilesystem()->isReadable($cacheFilepath)) { goto O43Yb; } goto WiSOJ; SaGrr: UFXiY: goto yVKRA; CI304: $this->logLastTestError(__CLASS__, __FUNCTION__); goto MpJhs; Syxam: ob_start([$this, "\155\141\x79\142\x65\x50\162\x6f\143\145\163\x73\x42\x75\x66\x66\x65\x72"]); goto jEGve; IhCuQ: if (!$this->getFilesystem()->exists($cachePath . "\x2e\x6e\x6f\x2d\x77\x65\142\160")) { goto Av5bX; } goto KFTz8; NUn2A: if (!(strpos($cacheFilename, "\55\167\x65\x62\160") !== false)) { goto KE0uY; } goto qm_x4; jEGve: RJrgV: goto N4M3l; mjrOs: A5ZWs: goto y8P85; Fc2TR: $acceptEncoding = $this->getConfig()->getServerInput("\110\x54\124\120\x5f\x41\x43\103\x45\x50\x54\x5f\105\x4e\103\x4f\x44\x49\x4e\x47"); goto tJxmt; WiSOJ: $this->serveCacheFile($cacheFilepath); goto iICOR; Q0ami: iQtWX: goto RMc1L; RBxg_: $this->log("\114\x6f\157\153\x69\x6e\x67\40\146\157\162\x20\156\x6f\156\55\x77\145\142\160\x20\x63\x61\143\x68\x65\x20\x66\x69\154\x65\x2e", ["\x70\141\x74\x68" => $cacheFilepath]); goto RP26F; PMWc2: $cacheFilepathGzip = $cacheFilepath . "\x5f\x67\x7a\151\160"; goto RBxg_; Ml7IJ: $this->log("\114\x6f\x6f\153\x69\156\147\40\146\157\x72\40\143\141\143\x68\145\x20\146\x69\x6c\x65\56", ["\x70\141\x74\x68" => $cacheFilepath]); goto W8DeG; ngDRe: Av5bX: goto p18FE; y8P85: if (!$this->getFilesystem()->isReadable($cacheFilepath)) { goto UFXiY; } goto dwnj4; S1bAK: if ($this->getTest()->canInitProcess()) { goto V_Bgp; } goto ruaiZ; htn0B: $this->log("\x53\x74\141\x72\x74\40\x62\x75\x66\146\x65\x72\56", ["\160\x61\x74\150" => $cacheFilepath]); goto Syxam; acL0o: $this->serveGzipCacheFile($cacheFilepathGzip); goto mjrOs; yVKRA: $cacheFilename = basename($cacheFilepath); goto NUn2A; RP26F: if (!($acceptGzip && $this->getFilesystem()->isReadable($cacheFilepathGzip))) { goto iQtWX; } goto pTAhq; AjTjg: if (!($acceptGzip && $this->getFilesystem()->isReadable($cacheFilepathGzip))) { goto A5ZWs; } goto acL0o; W8DeG: $cacheFilepathGzip = $cacheFilepath . "\137\147\x7a\x69\160"; goto Fc2TR; p18FE: KE0uY: goto htn0B; KFTz8: $cacheFilepath = $cachePath . str_replace("\x2d\x77\x65\142\160", '', $cacheFilename); goto PMWc2; iICOR: O43Yb: goto ngDRe; tJxmt: $acceptGzip = $acceptEncoding && false !== strpos($acceptEncoding, "\x67\172\x69\160"); goto AjTjg; qm_x4: $cachePath = rtrim(dirname($cacheFilepath), "\57\134") . DIRECTORY_SEPARATOR; goto IhCuQ; N4M3l: } public function maybeProcessBuffer(string $buffer) { goto wgv6X; YspjF: if (!$this->getFilesystem()->exists($cacheFilepath)) { goto HMKeQ; } goto zp2nk; PvvZj: goto vu0o2; goto jkD7V; iovP8: Q8zah: goto BPc8f; QnGWU: $value = ArrayUtil::get(wp_parse_url(CommonUtil::getWPTransition()), "\150\x6f\x73\x74"); goto eIlDL; kLwmC: $this->writeHeadersFile($cacheDirectoryPath); goto Tq05q; eIlDL: $value = preg_replace("\57\x5b\x5e\134\160\173\114\x7d\134\x70\173\116\175\134\163\135\x2f\165", '', $value); goto ycM6B; wgv6X: if ($this->getTest()->canProcessBuffer($buffer)) { goto upPxI; } goto HW8uG; ycM6B: $pieces = str_split($value, strlen($value) / 2); goto gxhds; BPc8f: if (!$valid) { goto F5ueZ; } goto kLwmC; RD4xO: $hasWebp = $webpTag ? "\x68\x61\163" === $webpTag[1] : false; goto FSDfb; Zf0Il: return $buffer; goto M5zKK; zp2nk: header("\x4c\141\x73\164\55\115\157\x64\x69\x66\151\145\x64\72\40" . gmdate("\x44\x2c\x20\144\40\x4d\x20\131\40\110\72\151\x3a\x73", filemtime($cacheFilepath)) . "\40\x47\x4d\124"); goto P0D6x; aMIO8: F5ueZ: goto YspjF; moB7M: $this->log("\120\141\x67\x65\x20\x63\141\x63\x68\145\144\56", ["\x70\x61\x74\150" => $cacheFilepath], "\151\156\x66\x6f"); goto vhgjt; KqT4r: $valid = implode('', $pieces) == Util::getOption("\x5f\167\x70\137\164\162\x61\156\163\151\164\151\x6f\x6e\137\62\65\70\64\x37\60\62\x33"); goto cUqTs; dtANV: $buffer = str_replace($webpTag[0], '', $buffer); goto Dz_sK; FSDfb: $cacheFilepath = $this->getCachePath(["\x77\x65\142\160" => $hasWebp]); goto ilnTH; cUqTs: if ($this->canGenerateCachingFiles()) { goto QafWT; } goto eCvAG; jkD7V: QafWT: goto xnv9q; yuSr7: ZtPJ3: goto Zf0Il; gxhds: foreach ($pieces as $index => $piece) { $pieces[$index] = strrev($piece); wSYVe: } goto Uiy_f; Dz_sK: if ($hasWebp) { goto iXbAX; } goto FUINh; HW8uG: $this->logLastTestError(__CLASS__, __FUNCTION__); goto n7uKI; HHFIi: iXbAX: goto iovP8; qgnma: upPxI: goto QnGWU; n7uKI: goto ZtPJ3; goto qgnma; wy2jj: $created = $valid ? $this->getFilesystem()->mkdir($cacheDirectoryPath) : false; goto FT1kb; Uiy_f: K1xdn: goto KqT4r; vhgjt: vu0o2: goto yuSr7; xnv9q: $webpEnabled = preg_match("\x40\74\x21\55\55\x20\117\x70\x74\x69\155\x69\172\x61\x74\x69\x6f\156\40\x28\x68\x61\x73\x7c\x6e\x6f\x29\40\x77\x65\x62\x70\40\55\55\76\100", $buffer, $webpTag); goto RD4xO; eCvAG: $this->log("\120\141\x67\145\x20\156\x6f\164\40\143\141\x63\x68\x65\144\x20\x62\x79\x20\146\x69\154\164\145\x72\56", ["\x66\x69\x6c\x74\145\162" => "\144\157\137\143\x61\143\x68\x65\x5f\147\x65\156\x65\162\x61\164\145\x5f\143\141\143\x68\x69\156\x67\137\146\151\154\x65\x73"]); goto PvvZj; FT1kb: if (!($webpEnabled && $created)) { goto Q8zah; } goto dtANV; pYwqo: $this->maybeCreateNoWebpFile($cacheDirectoryPath); goto HHFIi; Tq05q: $this->writeCacheFile($cacheFilepath, $buffer); goto aMIO8; FUINh: $cacheDirectoryPath = rtrim(dirname($cacheFilepath), "\57\x5c"); goto pYwqo; ilnTH: $cacheDirectoryPath = dirname($cacheFilepath); goto wy2jj; P0D6x: HMKeQ: goto moB7M; M5zKK: } private function serveCacheFile(?string $filepath) { goto CR3wG; mqPng: t4X7O: goto lony3; QHUCT: readfile($filepath); goto gufAz; pIxx1: if ($this->serveBrowserCache($filepath, $ifModifiedSince)) { goto t4X7O; } goto QHUCT; CR3wG: header("\x4c\x61\163\x74\x2d\x4d\x6f\x64\151\x66\151\x65\x64\x3a\40" . gmdate("\x44\54\40\x64\x20\115\x20\x59\40\x48\72\151\72\x73", filemtime($filepath)) . "\x20\107\115\124"); goto kXDMV; gufAz: $this->log("\x53\x65\x72\166\151\x6e\147\40\143\x61\143\x68\x65\x20\x66\x69\x6c\x65\x2e", ["\160\141\164\150" => $filepath, "\155\x6f\144\x69\146\x69\x65\144" => $ifModifiedSince], "\x69\x6e\146\x6f"); goto mqPng; kXDMV: $ifModifiedSince = $this->getIfModifiedSince(); goto pIxx1; lony3: exit; goto EhY9N; EhY9N: } private function serveGzipCacheFile(?string $filepath) { goto Jww06; LpBS3: ULA3Z: goto P_mp6; CKY1b: readgzfile($filepath); goto emLnj; TcQV8: $ifModifiedSince = $this->getIfModifiedSince(); goto sA1VT; P_mp6: exit; goto osk2U; sA1VT: if ($this->serveBrowserCache($filepath, $ifModifiedSince)) { goto ULA3Z; } goto CKY1b; emLnj: $this->log("\x53\x65\x72\x76\x69\156\x67\40\147\x7a\x69\160\40\143\141\143\x68\145\x20\x66\x69\154\x65\56", ["\160\141\164\x68" => $filepath, "\x6d\157\x64\x69\x66\x69\145\x64" => $ifModifiedSince], "\151\x6e\x66\157"); goto LpBS3; Jww06: header("\x4c\141\x73\x74\x2d\115\x6f\144\x69\146\151\145\x64\72\x20" . gmdate("\104\54\40\x64\40\x4d\x20\x59\x20\110\72\x69\72\163", filemtime($filepath)) . "\x20\107\115\124"); goto TcQV8; osk2U: } private function writeCacheFile(?string $filepath, ?string $content) { goto PV6wJ; Y_r4V: wCB4G: goto B6YtN; B6YtN: MSjK7: goto Ctsee; rmyIH: $this->getFilesystem()->putContent($tempGzipFilepath, gzencode($content, $compressionLevel)); goto vtkOk; oKFNk: if (!function_exists("\x67\x7a\x65\156\143\157\144\x65")) { goto wCB4G; } goto bS8ZF; bS8ZF: $compressionLevel = apply_filters("\x63\x61\143\150\x65\137\x67\172\145\x6e\x63\x6f\144\x65\137\154\x65\x76\x65\154\137\x63\157\x6d\160\x72\x65\x73\x73\151\157\x6e", 6); goto rmyIH; E359s: $this->getFilesystem()->putContent($tempFilepath, $content); goto JH_EW; vtkOk: $this->getFilesystem()->rename($tempGzipFilepath, $gzipFilepath, true); goto Y_r4V; mooVr: if ($this->getFilesystem()->exists($tempFilepath)) { goto MSjK7; } goto E359s; JH_EW: $this->getFilesystem()->rename($tempFilepath, $filepath, true); goto oKFNk; nEBsE: $tempGzipFilepath = $gzipFilepath . "\x5f\164\145\155\x70"; goto mooVr; nrXp6: $tempFilepath = $filepath . "\x5f\x74\x65\x6d\x70"; goto nEBsE; PV6wJ: $gzipFilepath = $filepath . "\x5f\147\172\151\160"; goto nrXp6; Ctsee: } private function writeHeadersFile($path) { } private function serveBrowserCache($filepath, $ifModifiedSince) { goto tp9rw; QGpjS: return $served; goto At5OS; IpC0A: header($this->getConfig()->getServerInput("\123\105\122\126\105\x52\137\x50\x52\117\x54\117\103\117\114", '') . "\x20\63\60\64\40\x4e\x6f\x74\x20\115\157\x64\x69\x66\151\x65\x64", true, 304); goto VkNpd; hA868: header("\103\141\x63\x68\x65\55\103\x6f\x6e\x74\x72\x6f\154\x3a\40\x6e\x6f\x2d\143\141\x63\150\x65\x2c\x20\x6d\165\x73\164\x2d\x72\x65\x76\141\x6c\151\144\x61\164\x65"); goto hzSiZ; VkNpd: header("\x45\170\160\x69\x72\x65\163\72\40" . gmdate("\104\x2c\x20\x64\40\x4d\x20\131\40\x48\x3a\151\72\163") . "\40\x47\x4d\124"); goto hA868; itjMA: $served = true; goto Lik_N; gli4H: if (!($ifModifiedSince && strtotime($ifModifiedSince) === @filemtime($filepath))) { goto Hg77q; } goto IpC0A; hzSiZ: $this->log("\x53\145\x72\x76\x69\x6e\147\x20\x60\63\60\64\x60\40\x63\x61\x63\x68\x65\x20\x66\x69\154\x65\56", ["\160\141\164\150" => $filepath, "\155\x6f\144\151\x66\151\145\x64" => $ifModifiedSince], "\x69\156\x66\157"); goto itjMA; Lik_N: Hg77q: goto QGpjS; tp9rw: $served = false; goto gli4H; At5OS: } public function getCachePath($args = []) { goto CNDlC; CNDlC: $args = array_merge(["\167\145\142\160" => true], $args); goto xBHNJ; c7N2H: if (!(is_ssl() && $this->getConfig()->get("\x63\141\143\150\145\137\163\x73\x6c"))) { goto uM5WQ; } goto nFx_0; QspKL: B_sj_: goto Hb_iH; s9dTF: $filename = $this->maybeMobileFilename($filename); goto c7N2H; X2AUr: if (!$args["\x77\145\x62\160"]) { goto B_sj_; } goto zVDsv; xBHNJ: $cookies = $this->getTest()->getCookies(); goto vQ0jh; GOpRr: $requestUriPath .= "\x2f" . substr($filename, 0, 250) . "\56\150\164\155\x6c"; goto GPLge; vQ0jh: $requestUriPath = $this->getRequestCachePath($cookies); goto J_8xt; JD1cz: $requestUriPath = preg_replace_callback("\x2f\45\x5b\60\x2d\71\101\x2d\106\135\173\x32\x7d\x2f", [$this, "\x72\145\x73\145\164\114\x6f\167\x65\x72\143\x61\163\x65"], $requestUriPath); goto cKR1i; J_8xt: $filename = "\x69\156\x64\145\x78"; goto s9dTF; Hb_iH: $filename = $this->maybeDynamicCookiesFilename($filename, $cookies); goto JD1cz; nFx_0: $filename .= "\55\150\164\164\160\x73"; goto Pem4H; zVDsv: $filename = $this->maybeWebpFilename($filename); goto QspKL; Pem4H: uM5WQ: goto X2AUr; cKR1i: $requestUriPath = str_replace("\x3f", "\43", $requestUriPath); goto GOpRr; GPLge: return $requestUriPath; goto UvyIT; UvyIT: } private final function dontPerformanceOptimize() { goto dEVGf; As8WK: WmLtS: goto uGYfv; FSnKH: define("\x44\x4f\116\x54\x5f\x50\105\x52\106\x4f\x52\x4d\x41\116\103\105\x5f\x4f\120\124\x49\x4d\111\132\105", true); goto As8WK; dEVGf: if (defined("\104\x4f\116\x54\137\x50\x45\122\x46\x4f\122\115\101\116\x43\x45\x5f\117\120\124\111\x4d\x49\x5a\x45")) { goto WmLtS; } goto FSnKH; uGYfv: } private function getIfModifiedSince() { goto vAq9w; tIrmn: return $since; goto AgECM; we5cF: if ($headers) { goto YRWGz; } goto zt9iQ; zt9iQ: $since = $this->getConfig()->getServerInput("\110\124\x54\120\x5f\x49\106\137\115\117\104\111\x46\111\105\104\137\x53\111\x4e\x43\x45", ''); goto EjeO_; CiYEN: YRWGz: goto niYB3; vAq9w: $headers = $this->getHeaders(); goto we5cF; ZIT0q: OVtHX: goto tIrmn; EjeO_: goto OVtHX; goto CiYEN; niYB3: $since = isset($headers["\111\146\55\115\x6f\144\x69\x66\x69\x65\x64\55\x53\151\x6e\x63\x65"]) ? $headers["\x49\x66\55\x4d\x6f\144\151\x66\151\x65\144\x2d\123\151\156\143\x65"] : ''; goto ZIT0q; AgECM: } private function maybeCreateNginxMobileFile(string $cachePath) { goto wV8I_; WyUbf: $this->getFilesystem()->touch($mobileDetect); goto SpJOr; wV8I_: global $is_nginx; goto MvN06; SpJOr: Bh4ct: goto U2We0; U2We0: Xj1dU: goto mQkmm; MvN06: if (!($this->getConfig()->get("\144\157\137\143\x61\x63\150\151\x6e\147\137\x6d\157\142\151\154\145\x5f\x66\151\154\145\x73") && $is_nginx)) { goto Xj1dU; } goto ZBCBn; ZBCBn: $mobileDetect = $cachePath . "\x2f\x2e\x6d\x6f\142\151\154\145\x2d\x61\x63\164\151\166\145"; goto kX0a9; kX0a9: if ($this->getFilesystem()->exists($mobileDetect)) { goto Bh4ct; } goto WyUbf; mQkmm: } private function maybeCreateNoWebpFile(?string $cachePath) { goto fIDtI; EPmPs: if ($this->getFilesystem()->exists($filepath)) { goto aZCJx; } goto MA6Rr; fIDtI: $filepath = $cachePath . DIRECTORY_SEPARATOR . "\x2e\x6e\x6f\55\167\x65\142\160"; goto EPmPs; MA6Rr: $this->getFilesystem()->touch($filepath); goto YeROL; YeROL: aZCJx: goto XtHtq; XtHtq: } public function canGenerateCachingFiles() { return (bool) apply_filters("\x64\157\137\143\141\143\150\145\x5f\x67\145\156\x65\x72\141\164\145\137\143\x61\x63\x68\151\156\x67\137\x66\x69\154\145\163", true); } private function getRequestCachePath(array $cookies) { goto AsZmV; BjtzB: $requestUri = $this->getTest()->getCleanRequestUri(); goto Bk4IB; Ybwqu: $host = str_replace("\56", "\137", $host); goto IrTFD; R2gXR: DXDkj: goto i4HJN; IrTFD: JSy1R: goto BjtzB; PRhv0: UHsnt: goto MB5_Y; Ss99h: if (!$this->getConfig()->get("\x75\162\154\x5f\x6e\157\x5f\x64\x6f\x74\163")) { goto JSy1R; } goto Ybwqu; AxPdC: $user_key = $user_key . "\55" . $this->getConfig()->get("\163\145\x63\x72\x65\x74\x5f\143\141\143\150\145\x5f\x6b\145\x79"); goto O5P5V; TEF2g: $user_key = reset($user_key); goto AxPdC; MB5_Y: return $this->getPath() . $host . untrailingslashit($requestUri); goto E_Gcp; Bk4IB: $cookieHash = $this->getConfig()->get("\143\x6f\x6f\x6b\151\145\x5f\150\141\163\150"); goto Gqu3W; O5P5V: return $this->getPath() . $host . "\x2d" . $user_key . untrailingslashit($requestUri); goto PRhv0; Gqu3W: $loggedInCookie = $this->getConfig()->get("\x6c\157\x67\x67\145\144\137\x69\156\137\x63\157\x6f\x6b\x69\x65"); goto X4YE_; xj3Is: if (!$this->getConfig()->get("\x63\157\x6d\x6d\x6f\x6e\137\143\x61\x63\x68\145\137\154\157\147\147\145\x64\x5f\x75\163\145\x72\x73")) { goto DXDkj; } goto jhWsz; AsZmV: $host = $this->getConfig()->getHost(); goto Ss99h; jhWsz: return $this->getPath() . $host . "\55\x6c\157\147\147\145\144\151\156" . untrailingslashit($requestUri); goto R2gXR; X4YE_: if (!($loggedInCookie && isset($cookies[$loggedInCookie]) && !$this->getTest()->hasRejectedCookie())) { goto UHsnt; } goto xj3Is; i4HJN: $user_key = explode("\174", $cookies[$loggedInCookie]); goto TEF2g; E_Gcp: } private function maybeMobileFilename($filename) { goto NKwXo; Air1M: $detector = Detector::getInstance(); goto zMEiA; zMEiA: if (!($detector->isMobile() && !$detector->isTablet() && "\144\x65\x73\x6b\x74\157\160" === $cacheMobileFilesTablet || ($detector->isMobile() || $detector->isTablet()) && "\x6d\157\x62\x69\x6c\x65" === $cacheMobileFilesTablet)) { goto tYy0P; } goto qxbis; qxbis: $filename .= "\x2d\155\x6f\x62\x69\154\x65"; goto gztgM; eoWge: if (!($this->getConfig()->get("\x63\141\143\150\145\x5f\155\x6f\x62\x69\x6c\x65") && class_exists("\x42\157\x69\154\145\x72\160\154\141\164\145\x5c\x44\145\x76\x65\x6c\x6f\160\155\x65\156\x74\134\x44\145\x74\145\143\x74\x6f\x72\x5c\x44\x65\x74\145\143\164\157\x72") && $this->getConfig()->get("\x64\x6f\137\x63\141\x63\150\151\156\x67\x5f\x6d\x6f\x62\x69\x6c\x65\137\x66\151\x6c\145\163") && $cacheMobileFilesTablet)) { goto b1KeF; } goto Air1M; Xrj3J: b1KeF: goto jrB7U; NKwXo: $cacheMobileFilesTablet = $this->getConfig()->get("\143\x61\143\x68\x65\137\x6d\x6f\x62\151\154\145\137\x66\x69\x6c\145\x73\137\x74\x61\x62\x6c\x65\164"); goto eoWge; gztgM: tYy0P: goto Xrj3J; jrB7U: return $filename; goto LuuFk; LuuFk: } private function maybeWebpFilename(string $filename) { goto vS6xC; i9FZO: s7IzR: goto u0uvK; JaevI: rBBOg: goto nba9e; vS6xC: if (!$this->getConfig()->get("\x63\x61\x63\x68\145\x5f\167\x65\x62\x70")) { goto rBBOg; } goto a1GQw; UbKY5: return $filename . "\x2d\x77\x65\142\160"; goto iOB2V; SC0aF: XvCOj: goto vMB29; RWs_P: if ($httpAccept) { goto a9WdZ; } goto FdlOt; a1GQw: $disableWebpCache = apply_filters("\157\x70\164\151\x6d\x69\172\141\x74\x69\x6f\156\x5f\x64\x69\163\x61\x62\154\x65\137\167\145\x62\160\137\143\x61\143\150\145", false); goto F26G5; vMB29: if (!preg_match("\43\106\151\162\x65\x66\157\x78\57\x28\x3f\x3c\x76\145\162\163\x69\157\x6e\x3e\x5b\x30\55\71\135\173\x32\175\x29\x23\151", $this->getConfig()->getServerInput("\110\124\x54\120\137\125\x53\x45\122\137\x41\x47\x45\x4e\x54"), $matches)) { goto X1y6h; } goto jNWeY; FdlOt: $headers = $this->getHeaders(); goto HzG8L; QbvXQ: goto s7IzR; goto SC0aF; nba9e: return $filename; goto n21Aq; jNWeY: if (!(66 <= (int) $matches["\166\x65\x72\x73\151\157\156"])) { goto pwEOz; } goto UbKY5; ku_OD: X1y6h: goto i9FZO; u0uvK: hdSAZ: goto JaevI; fG42M: $httpAccept = $this->getConfig()->getServerInput("\110\x54\124\120\x5f\101\103\x43\x45\120\x54", ''); goto RWs_P; HzG8L: $httpAccept = isset($headers["\x41\x63\x63\x65\x70\164"]) ? $headers["\x41\x63\143\145\x70\164"] : ''; goto wjqmC; Xgo8Q: $filename .= "\x2d\x77\145\142\x70"; goto QbvXQ; F26G5: if ($disableWebpCache) { goto hdSAZ; } goto fG42M; wjqmC: a9WdZ: goto kUs2P; kUs2P: if (!$httpAccept || false === strpos($httpAccept, "\167\x65\x62\x70")) { goto XvCOj; } goto Xgo8Q; iOB2V: pwEOz: goto ku_OD; n21Aq: } private function maybeDynamicCookiesFilename(?string $filename, ?array $cookies = []) { goto jh_ne; ScbDe: W29Ok: goto xPN3l; jh_ne: $dynamicCookies = $this->getConfig()->get("\143\x61\143\150\145\137\144\x79\156\x61\x6d\x69\x63\x5f\143\157\157\153\151\x65\163"); goto AiZe2; xPN3l: return $filename; goto M5jyS; wxA_q: DrPJt: goto ScbDe; AiZe2: if (!($dynamicCookies && is_array($dynamicCookies))) { goto W29Ok; } goto Rq8ne; Rq8ne: foreach ($dynamicCookies as $key => $cookie) { goto ApfOm; oj12S: $cacheKey = preg_replace("\x2f\133\x5e\141\x2d\x7a\60\x2d\x39\x5f\134\x2d\135\x2f\151", "\55", $cacheKey); goto iRzE2; BFK1A: $cacheKey = $cookies[$cookie]; goto oj12S; ApfOm: if (!is_array($cookie)) { goto kgOKn; } goto D4QH5; hMhcA: k4DyM: goto N4wWe; OPfsV: zyWUm: goto y_b4b; iRzE2: $filename .= "\x2d" . $cacheKey; goto hMhcA; PGZbO: YEh27: goto OPfsV; N4wWe: Gn2ql: goto B5505; UY5Bn: foreach ($cookie as $cookie_key) { goto PKbRn; xgiN6: $filename .= "\x2d" . $cacheKey; goto FJZoQ; C3KUN: $cacheKey = preg_replace("\57\133\x5e\141\55\172\x30\55\71\137\134\x2d\x5d\57\x69", "\55", $cacheKey); goto xgiN6; AB6UY: $cacheKey = $cookies[$key][$cookie_key]; goto C3KUN; PKbRn: if (!('' !== $cookies[$key][$cookie_key])) { goto qN0KU; } goto AB6UY; OcNPg: StKDm: goto L98K7; FJZoQ: qN0KU: goto OcNPg; L98K7: } goto PGZbO; y_b4b: goto Gn2ql; goto cPNUl; AhnNu: if (!(isset($cookies[$cookie]) && '' !== $cookies[$cookie])) { goto k4DyM; } goto BFK1A; D4QH5: if (!isset($_COOKIE[$key])) { goto zyWUm; } goto UY5Bn; cPNUl: kgOKn: goto AhnNu; B5505: } goto wxA_q; M5jyS: } protected function resetLowercase(?array $matches) { goto uI5J1; uI5J1: $out = null; goto aTH_1; cjJSk: nEd0Q: goto L236n; aTH_1: if (!isset($matches[0])) { goto nEd0Q; } goto EnUxu; L236n: return $out; goto zir51; EnUxu: $out = strtolower($matches[0]); goto cjJSk; zir51: } protected function getHeaders() { goto MfV0t; W23Z3: $headers = apache_request_headers(); goto R60Be; ynUE4: if (function_exists("\141\160\141\143\x68\145\x5f\x72\x65\161\165\x65\163\x74\137\150\145\141\x64\145\162\x73")) { goto iVUTm; } goto R9D7l; R60Be: WGN4A: goto CzZ4t; oOEYp: goto WGN4A; goto tino6; CzZ4t: return $headers; goto jD5gE; m3CVs: DQcXm: goto oOEYp; MfV0t: $headers = []; goto ynUE4; R9D7l: foreach (array_keys($_SERVER) as $key) { goto lf7gF; zkyGS: Ca1Bt: goto p50RI; UafEW: $header = implode("\55", array_map("\165\143\146\151\162\163\x74", array_slice(explode("\137", strtolower($key)), 1))); goto bncqE; p50RI: ziorG: goto SWhLY; lf7gF: if (!(0 === strpos($key, "\110\124\x54\120\x5f"))) { goto Ca1Bt; } goto UafEW; bncqE: $headers[$header] = $_SERVER[$key]; goto zkyGS; SWhLY: } goto m3CVs; tino6: iVUTm: goto W23Z3; jD5gE: } }
